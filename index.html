const fs = require("fs");
const axios = require("axios");
const figlet = require("figlet");
const chalk = require("chalk");

// Load tokens from tokens.txt
const tokens = fs.readFileSync("./tokens.txt", "utf-8").split("\n").filter(Boolean);

const hypeTypes = {
  1: "Bravery ",
  2: "Brilliance ",
  3: "Balance "
};

let success = 0;
let failed = 0;

console.clear();
console.log(chalk.green(figlet.textSync("2050")));
console.log(chalk.blue("Screw Services - Advanced HypeSquad Manager"));
console.log(chalk.blue("Developed by .884."));
console.log(chalk.yellowBright("Loading tool...\n"));

console.log("Checking tokens...");
console.log(`Scanning ${tokens.length} tokens...\n`);

let valid = 0;
let invalid = 0;

const sleep = ms => new Promise(res => setTimeout(res, ms));

// Assign HypeSquad
(async () => {
  console.log(chalk.yellow("Assigning HypeSquad...\n"));
  console.log(`Username              | Hype  | Type       | Status`);
  console.log("———————————————————————————————");

  for (let token of tokens) {
    const type = Math.floor(Math.random() * 3) + 1;
    try {
      await axios.post(
        "https://discord.com/api/v9/hypesquad/online",
        { house_id: type },
        {
          headers: {
            Authorization: token.trim(),
            "Content-Type": "application/json"
          }
        }
      );

      const user = await axios.get("https://discord.com/api/v9/users/@me", {
        headers: {
          Authorization: token.trim()
        }
      });

      const username = `${user.data.username}#${user.data.discriminator}`;
      console.log(
        `${username.padEnd(22)}| YES   | ${hypeTypes[type].padEnd(10)}| ${chalk.green("SUCCESS")}`
      );
      success++;
      valid++;
    } catch (err) {
      console.log(`Unknown User           | NO    | Unknown    | ${chalk.red("FAILED")}`);
      failed++;
    }

    await sleep(1000); // Wait a bit between requests to avoid rate limits
  }

  console.log("\nSummary:");
  console.log(`Success: ${success}`);
  console.log(`Failed: ${failed}`);
  console.log(`Total valid tokens: ${success}`);
})();