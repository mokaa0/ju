const puppeteer = require('puppeteer');
const fs = require('fs').promises;
const fsSync = require('fs');

class DiscordAccountCreator {
    constructor() {
        this.browser = null;
        this.page = null;
    }

    // ูุฑุงุกุฉ ุฃูู ุณุทุฑ ูู ุงูููู
    async readFirstLine(filename) {
        try {
            if (!fsSync.existsSync(filename)) {
                console.error(`โ ููู ${filename} ุบูุฑ ููุฌูุฏ!`);
                return null;
            }
            
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            return lines.length > 0 ? lines[0].trim() : null;
        } catch (error) {
            console.error(`โ ุฎุทุฃ ูู ูุฑุงุกุฉ ${filename}:`, error.message);
            return null;
        }
    }

    // ุญุฐู ุฃูู ุณุทุฑ ูู ุงูููู
    async deleteFirstLine(filename) {
        try {
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length > 0) {
                const newContent = lines.slice(1).join('\n');
                await fs.writeFile(filename, newContent);
                console.log(`โ ุญุฐู ุฃูู ุณุทุฑ ูู ${filename}`);
                return true;
            }
            return false;
        } catch (error) {
            console.error(`โ ุฎุทุฃ ูู ุญุฐู ุงูุณุทุฑ ูู ${filename}:`, error.message);
            return false;
        }
    }

    // ุชูููุฏ ุชุงุฑูุฎ ุนุดูุงุฆู ุฃูู ูู 2006
    generateRandomDate() {
        const startYear = 1980;
        const endYear = 2005;
        
        const year = Math.floor(Math.random() * (endYear - startYear + 1)) + startYear;
        const month = Math.floor(Math.random() * 12) + 1;
        const day = Math.floor(Math.random() * 28) + 1;
        
        // Discord ูุณุชุฎุฏู ุฃุฑูุงู ุงูุดููุฑ (1-12)
        return {
            month: month.toString(),
            day: day.toString(),
            year: year.toString()
        };
    }

    // ุงูุชุธุงุฑ ุนุดูุงุฆู
    async randomDelay(min = 800, max = 1500) {
        const delay = Math.floor(Math.random() * (max - min + 1)) + min;
        await this.page.waitForTimeout(delay);
    }

    // ุงูุจุญุซ ุนู ุนูุตุฑ ุจุทุฑู ูุฎุชููุฉ
    async findElement(selectors) {
        for (const selector of selectors) {
            try {
                const element = await this.page.$(selector);
                if (element) {
                    console.log(`โ ูุฌุฏุช ุงูุนูุตุฑ ุจุงุณุชุฎุฏุงู: ${selector}`);
                    return element;
                }
            } catch (error) {
                // ุชุฌุงูู ุงูุฎุทุฃ ูุฌุฑุจ selector ุงูุชุงูู
            }
        }
        return null;
    }

    // ููุก ุชุงุฑูุฎ ุงููููุงุฏ ุจุทุฑู ูุฎุชููุฉ
    async fillBirthDate(birthDate) {
        console.log('๐ ูุญุงููุฉ ููุก ุชุงุฑูุฎ ุงููููุงุฏ...');
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Month
        const monthSelectors = [
            'select[aria-label="Month"]',
            'select[name="birthday_month"]',
            'select[id="birthdayMonth"]',
            'select[class*="month"]',
            'select:nth-of-type(1)'
        ];
        
        const monthSelect = await this.findElement(monthSelectors);
        if (monthSelect) {
            await monthSelect.select(birthDate.month);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูุดูุฑ: ${birthDate.month}`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงูุดูุฑุ ุณุฃุณุชุฎุฏู ุงูุฅุฏุฎุงู ุงููุจุงุดุฑ');
            
            // ูุญุงููุฉ ุญููู ุฅุฏุฎุงู ุจุฏูุงู ูู select
            const monthInputSelectors = [
                'input[name="birthday_month"]',
                'input[placeholder*="month" i]',
                'input[aria-label*="month" i]'
            ];
            
            const monthInput = await this.findElement(monthInputSelectors);
            if (monthInput) {
                await monthInput.type(birthDate.month);
                console.log(`โ ูุชุจุช ุงูุดูุฑ ูู ุญูู ุฅุฏุฎุงู: ${birthDate.month}`);
            }
        }
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Day
        const daySelectors = [
            'select[aria-label="Day"]',
            'select[name="birthday_day"]',
            'select[id="birthdayDay"]',
            'select[class*="day"]',
            'select:nth-of-type(2)'
        ];
        
        const daySelect = await this.findElement(daySelectors);
        if (daySelect) {
            await daySelect.select(birthDate.day);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูููู: ${birthDate.day}`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงูููู');
            
            const dayInputSelectors = [
                'input[name="birthday_day"]',
                'input[placeholder*="day" i]'
            ];
            
            const dayInput = await this.findElement(dayInputSelectors);
            if (dayInput) {
                await dayInput.type(birthDate.day);
                console.log(`โ ูุชุจุช ุงูููู ูู ุญูู ุฅุฏุฎุงู: ${birthDate.day}`);
            }
        }
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Year
        const yearSelectors = [
            'select[aria-label="Year"]',
            'select[name="birthday_year"]',
            'select[id="birthdayYear"]',
            'select[class*="year"]',
            'select:nth-of-type(3)'
        ];
        
        const yearSelect = await this.findElement(yearSelectors);
        if (yearSelect) {
            await yearSelect.select(birthDate.year);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูุณูุฉ: ${birthDate.year}`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงูุณูุฉ');
            
            const yearInputSelectors = [
                'input[name="birthday_year"]',
                'input[placeholder*="year" i]'
            ];
            
            const yearInput = await this.findElement(yearInputSelectors);
            if (yearInput) {
                await yearInput.type(birthDate.year);
                console.log(`โ ูุชุจุช ุงูุณูุฉ ูู ุญูู ุฅุฏุฎุงู: ${birthDate.year}`);
            }
        }
        
        console.log(`๐ ุชุงุฑูุฎ ุงููููุงุฏ ุงูููุงุฆู: ${birthDate.month}/${birthDate.day}/${birthDate.year}`);
    }

    // ุงูุญุตูู ุนูู ุงูุชููู
    async getDiscordToken() {
        try {
            return await this.page.evaluate(() => {
                // ุงูุจุญุซ ูู localStorage
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    if (value && value.length > 50 && (key.toLowerCase().includes('token') || value.match(/[\w-]+\.[\w-]+\.[\w-]+/))) {
                        return value;
                    }
                }

                // ุงูุจุญุซ ูู cookies
                const cookies = document.cookie.split(';');
                for (const cookie of cookies) {
                    const [name, value] = cookie.trim().split('=');
                    if (value && value.length > 50 && name.toLowerCase().includes('token')) {
                        return value;
                    }
                }

                // ุงูุจุญุซ ูู ูุต ุงูุตูุญุฉ
                const bodyText = document.body.innerText;
                const tokenMatch = bodyText.match(/[\w-]{24}\.[\w-]{6}\.[\w-]{27}/);
                if (tokenMatch) {
                    return tokenMatch[0];
                }

                return null;
            });
        } catch (error) {
            console.error('โ ุฎุทุฃ ูู ุงูุญุตูู ุนูู ุงูุชููู:', error.message);
            return null;
        }
    }

    // ุงูุถุบุท ุนูู ุฒุฑ ุงูุฅูุดุงุก
    async clickCreateButton() {
        console.log('๐ ุงูุจุญุซ ุนู ุฒุฑ ุงูุฅูุดุงุก...');
        
        // ูุงุฆูุฉ ุจุฌููุน ุงูุฃุฒุฑุงุฑ ุงููุญุชููุฉ
        const buttonSelectors = [
            'button[type="submit"]',
            'button[data-testid="continue-button"]',
            'button:has-text("Continue")',
            'button:has-text("ุงูุชุงูู")',
            'button:has-text("Create Account")',
            'button:has-text("ุฅูุดุงุก ุญุณุงุจ")',
            'button[aria-label*="continue" i]',
            'button[aria-label*="create" i]'
        ];
        
        // ูุญุงููุฉ ูู selector
        for (const selector of buttonSelectors) {
            try {
                const button = await this.page.$(selector);
                if (button) {
                    await button.click();
                    console.log(`โ ุชู ุงูููุฑ ุนูู ุฒุฑ ุงูุฅูุดุงุก ุจุงุณุชุฎุฏุงู: ${selector}`);
                    return true;
                }
            } catch (error) {
                // ุชุฌุงูู ุงูุฎุทุฃ ูุฌุฑุจ selector ุงูุชุงูู
            }
        }
        
        // ูุญุงููุฉ ุจุงุณุชุฎุฏุงู JavaScript
        console.log('โ๏ธ  ูู ุฃุฌุฏ ุงูุฒุฑ ุจุงูู selectorsุ ุฃุฌุฑุจ ุจู JavaScript...');
        try {
            const clicked = await this.page.evaluate(() => {
                const buttons = document.querySelectorAll('button');
                for (const button of buttons) {
                    const text = button.textContent || button.innerText || '';
                    const lowerText = text.toLowerCase();
                    
                    if (lowerText.includes('continue') || 
                        lowerText.includes('create') || 
                        lowerText.includes('ุงูุชุงูู') || 
                        lowerText.includes('ุฅูุดุงุก') ||
                        button.type === 'submit') {
                        button.click();
                        return true;
                    }
                }
                
                // ุฅุฐุง ูู ุชุฌุฏ ุฒุฑ ููุงุณุจุ ุญุงูู ุงูุนุซูุฑ ุนูู ุฃู ุฒุฑ submit
                const submitButtons = document.querySelectorAll('[type="submit"]');
                if (submitButtons.length > 0) {
                    submitButtons[0].click();
                    return true;
                }
                
                return false;
            });
            
            if (clicked) {
                console.log('โ ุชู ุงูููุฑ ุนูู ุฒุฑ ุงูุฅูุดุงุก ุจุงุณุชุฎุฏุงู JavaScript');
                return true;
            }
        } catch (error) {
            console.log('โ ูุดู ุงูููุฑ ุจุงุณุชุฎุฏุงู JavaScript:', error.message);
        }
        
        return false;
    }

    // ุฅูุดุงุก ุญุณุงุจ ูุงุญุฏ
    async createSingleAccount() {
        try {
            console.log('\n๐ ุฌูุจ ุงูุจูุงูุงุช ูู ุงููููุงุช...');

            // ูุฑุงุกุฉ ุฃูู ุณุทุฑ ูู ูู ููู
            const email = await this.readFirstLine('gmails.txt');
            const displayName = await this.readFirstLine('names.txt');
            const username = await this.readFirstLine('username.txt');
            const password = await this.readFirstLine('password.txt');

            // ุงูุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช
            if (!email || !displayName || !username || !password) {
                console.error('โ ูุง ุชูุฌุฏ ุจูุงูุงุช ูุงููุฉ ูู ุงููููุงุช!');
                return false;
            }

            console.log(`
๐ง ุงูุฅูููู: ${email}
๐ค Display Name: ${displayName}
๐ค ุงูููุฒุฑููู: ${username}
๐ ุงูุจุงุณูุฑุฏ: ${password}
            `);

            // ูุชุญ ุตูุญุฉ Discord ููุชุณุฌูู
            console.log('๐ ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุชุณุฌูู Discord...');
            await this.page.goto('https://discord.com/register', { 
                waitUntil: 'domcontentloaded',
                timeout: 30000
            });
            
            await this.randomDelay(3000, 4000);

            // ุงูุชุญูู ูู ุฃููุง ูู ุงูุตูุญุฉ ุงูุตุญูุญุฉ
            const pageUrl = await this.page.url();
            const pageTitle = await this.page.title();
            console.log(`๐ ุงูุนููุงู: ${pageTitle}`);
            console.log(`๐ ุงูุฑุงุจุท: ${pageUrl}`);

            // ุงูุชูุงุท screenshot ููุตูุญุฉ ุงูุฃูููุฉ
            await this.page.screenshot({ path: 'initial_page.png' });
            console.log('๐ธ ุชู ุญูุธ ุตูุญุฉ ุงูุจุฏุงูุฉ');

            // ุงูุจุญุซ ุนู ุญูู ุงูุฅูููู ูููุคู
            console.log('โ๏ธ  ุงูุจุญุซ ุนู ุญูู ุงูุฅูููู...');
            const emailSelectors = [
                'input[name="email"]',
                'input[type="email"]',
                'input[placeholder*="email" i]',
                'input[aria-label*="email" i]',
                'input[id*="email"]'
            ];
            
            const emailField = await this.findElement(emailSelectors);
            if (emailField) {
                await emailField.type(email, { delay: 50 });
                console.log('โ ุชู ููุก ุญูู ุงูุฅูููู');
            } else {
                console.error('โ ูู ุฃุฌุฏ ุญูู ุงูุฅูููู!');
                return false;
            }
            
            await this.randomDelay();

            // ุงูุจุญุซ ุนู ุญูู Display Name ูููุคู
            console.log('โ๏ธ  ุงูุจุญุซ ุนู ุญูู Display Name...');
            const displayNameSelectors = [
                'input[name="displayName"]',
                'input[name="displayname"]',
                'input[placeholder*="display name" i]',
                'input[placeholder*="ุงุณู ุงูุนุฑุถ" i]',
                'input[aria-label*="display name" i]',
                'input[id*="displayName"]',
                'input[id*="displayname"]'
            ];
            
            const displayNameField = await this.findElement(displayNameSelectors);
            if (displayNameField) {
                await displayNameField.type(displayName, { delay: 50 });
                console.log('โ ุชู ููุก ุญูู Display Name');
            } else {
                console.log('โ๏ธ  ูู ุฃุฌุฏ ุญูู Display Nameุ ูุฏ ูุง ูููู ููุฌูุฏุงู ูู ูุฐุง ุงูุฅุตุฏุงุฑ');
            }
            
            await this.randomDelay();

            // ุงูุจุญุซ ุนู ุญูู Username ูููุคู
            console.log('โ๏ธ  ุงูุจุญุซ ุนู ุญูู Username...');
            const usernameSelectors = [
                'input[name="username"]',
                'input[placeholder*="username" i]',
                'input[placeholder*="ุงุณู ุงููุณุชุฎุฏู" i]',
                'input[aria-label*="username" i]',
                'input[id*="username"]'
            ];
            
            const usernameField = await this.findElement(usernameSelectors);
            if (usernameField) {
                await usernameField.type(username, { delay: 50 });
                console.log('โ ุชู ููุก ุญูู Username');
            } else {
                console.error('โ ูู ุฃุฌุฏ ุญูู Username!');
                return false;
            }
            
            await this.randomDelay();

            // ุงูุจุญุซ ุนู ุญูู Password ูููุคู
            console.log('โ๏ธ  ุงูุจุญุซ ุนู ุญูู Password...');
            const passwordSelectors = [
                'input[name="password"]',
                'input[type="password"]',
                'input[placeholder*="password" i]',
                'input[placeholder*="ูููุฉ ุงููุฑูุฑ" i]',
                'input[aria-label*="password" i]',
                'input[id*="password"]'
            ];
            
            const passwordField = await this.findElement(passwordSelectors);
            if (passwordField) {
                await passwordField.type(password, { delay: 50 });
                console.log('โ ุชู ููุก ุญูู Password');
            } else {
                console.error('โ ูู ุฃุฌุฏ ุญูู Password!');
                return false;
            }
            
            await this.randomDelay(1000, 1500);

            // ููุก ุชุงุฑูุฎ ุงููููุงุฏ
            const birthDate = this.generateRandomDate();
            await this.fillBirthDate(birthDate);
            
            await this.randomDelay(1000, 1500);

            // ุงูุชูุงุท screenshot ุจุนุฏ ููุก ุฌููุน ุงูุญููู
            await this.page.screenshot({ path: 'form_filled.png' });
            console.log('๐ธ ุชู ุญูุธ ุตูุญุฉ ุจุนุฏ ููุก ุงููููุฐุฌ');

            console.log('\nโโโ ุชู ููุก ุฌููุน ุงูุญููู ุจูุฌุงุญ! โโโ');
            console.log('   โ ุงูุฅูููู');
            console.log('   โ Display Name');
            console.log('   โ Username');
            console.log('   โ Password');
            console.log('   โ ุชุงุฑูุฎ ุงููููุงุฏ');

            // ุงูุชุธุงุฑ ุญู ุงููุงุจุชุดุง ูุฏููุงู
            console.log('\nโ๏ธ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
            console.log('โ๏ธ   ูุฑุฌู ุญู ุงูู Captcha ูุฏููุงู ูู ุงููุชุตูุญ!');
            console.log('โ๏ธ   ุจุนุฏ ุญู ุงูู Captchaุ ุงุถุบุท Enter ููุง ูููุชุงุจุนุฉ');
            console.log('โ๏ธ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ\n');
            
            // ุงุณุชุฎุฏุงู readline ููุงูุชุธุงุฑ ุญุชู ูููู ุงููุณุชุฎุฏู ุจุญู ุงููุงุจุชุดุง
            const readline = require('readline');
            const rl = readline.createInterface({
                input: process.stdin,
                output: process.stdout
            });
            
            await new Promise(resolve => {
                rl.question('ุจุนุฏ ุญู ุงูู Captchaุ ุงุถุบุท Enter ูููุชุงุจุนุฉ...', () => {
                    rl.close();
                    resolve();
                });
            });
            
            // ุงูุงูุชุธุงุฑ 2 ุซุงููุฉ ุจุนุฏ ุญู ุงููุงุจุชุดุง
            await this.page.waitForTimeout(2000);

            // ุงูุถุบุท ุนูู ุฒุฑ ุงูุฅูุดุงุก
            const buttonClicked = await this.clickCreateButton();
            
            if (!buttonClicked) {
                console.error('โ ูู ุฃุณุชุทุน ุงูููุฑ ุนูู ุฒุฑ ุงูุฅูุดุงุก!');
                return false;
            }

            // ุงูุชุธุงุฑ ุฅูุดุงุก ุงูุญุณุงุจ
            console.log('โณ ุงูุชุธุงุฑ ุฅูุดุงุก ุงูุญุณุงุจ... (15 ุซุงููุฉ)');
            await this.page.waitForTimeout(15000);

            // ุงูุชูุงุท screenshot ุจุนุฏ ุงูุฅูุดุงุก
            await this.page.screenshot({ path: 'account_created.png' });
            console.log('๐ธ ุชู ุญูุธ ุตูุญุฉ ุจุนุฏ ุฅูุดุงุก ุงูุญุณุงุจ');

            // ูุญุงููุฉ ุงูุญุตูู ุนูู ุงูุชููู
            console.log('๐ ุฌุงุฑู ุงูุญุตูู ุนูู ุงูุชููู...');
            
            let token = null;
            for (let attempt = 1; attempt <= 5; attempt++) {
                console.log(`๐ ุงููุญุงููุฉ ${attempt}/5 ููุญุตูู ุนูู ุงูุชููู...`);
                token = await this.getDiscordToken();
                
                if (token) {
                    console.log(`โ ุชู ุงูุญุตูู ุนูู ุงูุชููู ูู ุงููุญุงููุฉ ${attempt}`);
                    break;
                }
                
                if (attempt < 5) {
                    await this.page.waitForTimeout(3000);
                }
            }

            if (token) {
                console.log('๐ ุชู ุงูุญุตูู ุนูู ุงูุชููู ุจูุฌุงุญ!');
                console.log(`๐ ุงูุชููู (ุงูุฃูู 30 ุญุฑู): ${token.substring(0, 30)}...`);
                
                // ุญูุธ ุงูุชููู
                await fs.appendFile('tokens.txt', `${token}\n`, 'utf8');
                console.log('๐พ ุชู ุญูุธ ุงูุชููู ูู tokens.txt');
                
                // ุญูุธ ูุนูููุงุช ุงูุญุณุงุจ
                const accountInfo = `
===========================================
๐ ุงูุชุงุฑูุฎ: ${new Date().toLocaleString()}
๐ง ุงูุฅูููู: ${email}
๐ค Display Name: ${displayName}
๐ค ุงูููุฒุฑููู: ${username}
๐ ุงูุจุงุณูุฑุฏ: ${password}
๐ ุงูุชููู: ${token.substring(0, 30)}...
===========================================
                `;
                
                await fs.appendFile('accounts_info.txt', accountInfo, 'utf8');
                console.log('๐ ุชู ุญูุธ ูุนูููุงุช ุงูุญุณุงุจ ูู accounts_info.txt');
                
                // ุญุฐู ุงูุฃุณุทุฑ ุงููุณุชุฎุฏูุฉ
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('๐๏ธ  ุชู ุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงููููุงุช');
                return token;
            } else {
                console.log('โ ูู ูุชู ุงูุญุตูู ุนูู ุงูุชููู!');
                
                // ุญูุธ ุงููุนูููุงุช ุฑุบู ุนุฏู ูุฌูุฏ ุชููู
                await fs.appendFile('no_token_accounts.txt', 
                    `${email}:${username}:${password}:${new Date().toISOString()}\n`, 
                    'utf8'
                );
                
                // ุญุฐู ุงูุฃุณุทุฑ ุงููุณุชุฎุฏูุฉ
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('โ๏ธ  ุชู ุญูุธ ุงูุญุณุงุจ ุจุฏูู ุชููู ูุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ');
                return false;
            }

        } catch (error) {
            console.error('โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุญุณุงุจ:', error.message);
            console.error('Stack:', error.stack);
            
            // ุญูุธ ุงูุฎุทุฃ ูู ููู
            const errorLog = `[${new Date().toISOString()}] ${error.message}\n${error.stack}\n\n`;
            await fs.appendFile('error_log.txt', errorLog, 'utf8');
            
            return false;
        }
    }

    async run() {
        console.log(`
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ     Discord Account Creator - FIXED      โ
โ   (ุชู ุฅุตูุงุญ ูุดุงูู ุงูู Selectors)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        `);
        
        // ุงูุชุญูู ูู ูุฌูุฏ ุงููููุงุช
        const requiredFiles = ['gmails.txt', 'names.txt', 'username.txt', 'password.txt'];
        console.log('๐ ุงูุชุญูู ูู ูุฌูุฏ ุงููููุงุช...');
        
        for (const file of requiredFiles) {
            if (fsSync.existsSync(file)) {
                const firstLine = await this.readFirstLine(file);
                if (firstLine) {
                    console.log(`   โ ${file}: ${firstLine.substring(0, 20)}...`);
                } else {
                    console.log(`   โ ${file}: ูุงุฑุบ!`);
                }
            } else {
                console.log(`   โ ${file}: ุบูุฑ ููุฌูุฏ!`);
            }
        }

        try {
            console.log('\n๐ ุจุฏุก ุชุดุบูู ุงููุชุตูุญ...');
            
            // ุชุดุบูู ุงููุชุตูุญ ูุน ุฅุนุฏุงุฏุงุช ูุญุณูุฉ
            this.browser = await puppeteer.launch({ 
                headless: false,
                defaultViewport: null,
                args: [
                    '--start-maximized',
                    '--no-sandbox',
                    '--disable-setuid-sandbox',
                    '--disable-dev-shm-usage',
                    '--disable-blink-features=AutomationControlled',
                    '--disable-features=IsolateOrigins,site-per-process'
                ],
                ignoreHTTPSErrors: true,
                executablePath: process.platform === 'win32' 
                    ? 'C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe'
                    : undefined
            });
            
            // ุฅูุดุงุก ุตูุญุฉ ุฌุฏูุฏุฉ
            this.page = await this.browser.newPage();
            
            // ุฅุฎูุงุก automation
            await this.page.evaluateOnNewDocument(() => {
                // ุฅุฎูุงุก webdriver
                delete navigator.__proto__.webdriver;
            });
            
            // ุชุนููู user agent ูุงูุนู
            await this.page.setUserAgent(
                'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
            );

            console.log('โ ุชู ูุชุญ ุงููุชุตูุญ ุจูุฌุงุญ');
            console.log('๐ฏ ุฌุงุฑู ุฅูุดุงุก ุญุณุงุจ ูุงุญุฏ...\n');

            // ุฅูุดุงุก ุญุณุงุจ ูุงุญุฏ
            const token = await this.createSingleAccount();
            
            if (token) {
                console.log('\n๐๐๐ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ! ๐๐๐');
                console.log('โ ุชู ุงูุญุตูู ุนูู ุงูุชููู ูุญูุธู');
                console.log('โ ุชู ุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ');
            } else {
                console.log('\nโ๏ธ  ุชูุช ุงูุนูููุฉ ูุน ุจุนุถ ุงููุดุงูู');
                console.log('๐ ุฑุงุฌุน ููู error_log.txt ูููุฒูุฏ ูู ุงููุนูููุงุช');
            }

        } catch (error) {
            console.error('โ ุฎุทุฃ ูู ุชุดุบูู ุงูุฃุฏุงุฉ:', error.message);
            console.error('Stack:', error.stack);
        } finally {
            // ุฅุบูุงู ุงููุชุตูุญ ุจุนุฏ ุชุฃุฎูุฑ
            console.log('\nโณ ุฅุบูุงู ุงููุชุตูุญ ุจุนุฏ 5 ุซูุงูู...');
            
            try {
                await this.page.waitForTimeout(5000);
                
                if (this.browser) {
                    await this.browser.close();
                    console.log('โ ุชู ุฅุบูุงู ุงููุชุตูุญ');
                }
            } catch (closeError) {
                console.log('โ๏ธ  ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุบูุงู ุงููุชุตูุญ');
            }

            console.log('\n๐ ููุฎุต ุงูุนูููุฉ:');
            console.log('   1. ูุชุญ Chrome ูุฐูุจ ุฅูู Discord');
            console.log('   2. ูุฑุฃ ุฃูู ุณุทุฑ ูู ูู ููู');
            console.log('   3. ููุฃ ุงูุฅูููู โ');
            console.log('   4. ููุฃ Display Name (ุฅุฐุง ูุฌุฏ) โ');
            console.log('   5. ููุฃ Username โ');
            console.log('   6. ููุฃ Password โ');
            console.log('   7. ููุฃ ุชุงุฑูุฎ ุงููููุงุฏ โ');
            console.log('   8. ุงูุชุธุฑ ุญู ุงููุงุจุชุดุง ูุฏููุงู');
            console.log('   9. ููุฑ ุนูู ุฒุฑ ุงูุฅูุดุงุก โ');
            console.log('   10. ุญุงูู ุงูุญุตูู ุนูู ุงูุชููู');
            console.log('   11. ุญูุธ ุงูุชููู ูุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ');
            console.log('   12. ุฃุบูู ุงููุชุตูุญ');
            
            console.log('\n๐ ููุชุดุบูู ูุฑุฉ ุฃุฎุฑูุ ุฃุนุฏ ุชุดุบูู ุงูุจุฑูุงูุฌ');
        }
    }
}

// ุชุดุบูู ุงูุจุฑูุงูุฌ
(async () => {
    console.log(`
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ    Discord Account Creator - ููุฃุบุฑุงุถ ุงูุจุญุซูุฉ         โ
โ                                                       โ
โ  ุชู ุฅุตูุงุญ:                                            โ
โ  1. ูุดููุฉ select[aria-label="Month"]                 โ
โ  2. ูุดููุฉ Display Name                                โ
โ  3. ูุดููุฉ ุฒุฑ ุงูุฅูุดุงุก                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    `);
    
    const creator = new DiscordAccountCreator();
    await creator.run();
})();