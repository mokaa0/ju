const figlet = require("figlet");
const chalk = require("chalk");
const readline = require("readline");
const { Client } = require("discord.js-selfbot-v13");

console.clear();
console.log(figlet.textSync("Qya"));
console.log(chalk.hex("#89CFF0")("Qya Studio - Banner server")); // Baby Blue
console.log(chalk.yellow("Developed By .884."));
console.log(chalk.green("loading tool..."));

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

function ask(question) {
  return new Promise(resolve => rl.question(question, resolve));
}

async function main() {
  const token = await ask("Enter your Discord token: ");
  const client = new Client();

  client.on("ready", async () => {
    console.log(chalk.green("✅ Valid token"));

    const copyServerId = await ask(chalk.green("Enter server ID you need to copy: "));
    const copyGuild = client.guilds.cache.get(copyServerId);

    if (!copyGuild) {
      console.log(chalk.red("❌ You're not in that server (copy server)"));
      process.exit(1);
    }

    const pasteServerId = await ask(chalk.green("Enter server ID you need to paste: "));
    const pasteGuild = client.guilds.cache.get(pasteServerId);

    if (!pasteGuild) {
      console.log(chalk.red("❌ You're not in that server (paste server)"));
      process.exit(1);
    }

    const roomId = await ask(chalk.green("Enter room ID: "));
    const channel = pasteGuild.channels.cache.get(roomId);

    if (!channel || channel.type !== 0) {
      console.log(chalk.red("❌ Invalid or non-text channel ID"));
      process.exit(1);
    }

    try {
      const bannerURL = copyGuild.bannerURL({ size: 2048, extension: 'png' }) || "No banner";
      const iconURL = copyGuild.iconURL({ size: 1024, extension: 'png' }) || "No icon";

      const messageContent = `**Banner of ${copyGuild.name}**`;

      await channel.send(messageContent);

      if (iconURL !== "No icon") {
        await channel.send({ content: "Server Icon:", files: [iconURL] });
      }
      if (bannerURL !== "No banner") {
        await channel.send({ content: "Server Banner:", files: [bannerURL] });
      }

      console.log(chalk.green("✅ Banner and Icon sent successfully."));
    } catch (err) {
      console.log(chalk.red("❌ Failed to send banner or icon:"), err);
    }

    rl.close();
    process.exit(0);
  });

  client.on("error", () => {
    console.log(chalk.red("❌ Invalid token"));
    rl.close();
    process.exit(1);
  });

  try {
    await client.login(token);
  } catch (err) {
    console.log(chalk.red("❌ Invalid token"));
    rl.close();
    process.exit(1);
  }
}

main();