else if (i.commandName === "top") {
    const type = i.options.getString("type");
    
    if (type) {
        const topUsers = await coinsDB.getTopUsers(5, type);
        
        const embed = new EmbedBuilder()
            .setTitle(`Top 5 Users - ${type.charAt(0).toUpperCase() + type.slice(1)}`)
            .setColor("Gold")
            .setTimestamp();

        let description = "";
        topUsers.forEach((user, index) => {
            description += `${index + 1}# <@${user.userId}> - ${user[type]} coins\n`;
        });

        embed.setDescription(description);
        
        await i.reply({ embeds: [embed] });
    } else {
        const topOffline = await coinsDB.getTopUsers(5, "voice");
        const topOnline = await coinsDB.getTopUsers(5, "online");
        const topAuto = await coinsDB.getTopUsers(5, "auto");
        
        const embed = new EmbedBuilder()
            .setTitle("Top 5 Users - All Types")
            .setColor("Gold")
            .setTimestamp();

        let description = "**ðŸŸ£ Voice**\n";
        topOffline.forEach((user, index) => {
            description += `${index + 1}# <@${user.userId}> - ${user.voice}\n`;
        });
        
        description += "\n**ðŸŸ¢ Online**\n";
        topOnline.forEach((user, index) => {
            description += `${index + 1}# <@${user.userId}> - ${user.online}\n`;
        });
        
        description += "\n**ðŸŸ¡ Auto**\n";
        topAuto.forEach((user, index) => {
            description += `${index + 1}# <@${user.userId}> - ${user.auto}\n`;
        });

        embed.setDescription(description);
        
        await i.reply({ embeds: [embed] });
    }
}