const puppeteer = require('puppeteer');
const fs = require('fs').promises;
const fsSync = require('fs');

class DiscordAccountCreator {
    constructor() {
        this.browser = null;
        this.page = null;
    }

    // Ù‚Ø±Ø§Ø¡Ø© Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ù…Ù„Ù
    async readFirstLine(filename) {
        try {
            if (!fsSync.existsSync(filename)) {
                console.error(`âŒ Ù…Ù„Ù ${filename} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!`);
                return null;
            }
            
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            return lines.length > 0 ? lines[0].trim() : null;
        } catch (error) {
            console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© ${filename}:`, error.message);
            return null;
        }
    }

    // Ø­Ø°Ù Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ù…Ù„Ù
    async deleteFirstLine(filename) {
        try {
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length > 0) {
                const newContent = lines.slice(1).join('\n');
                await fs.writeFile(filename, newContent);
                console.log(`âœ… Ø­Ø°Ù Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† ${filename}`);
                return true;
            }
            return false;
        } catch (error) {
            console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø± Ù…Ù† ${filename}:`, error.message);
            return false;
        }
    }

    // Ø§Ù†ØªØ¸Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    async randomDelay(min = 500, max = 1000) {
        const delay = Math.floor(Math.random() * (max - min + 1)) + min;
        await this.page.waitForTimeout(delay);
    }

    // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name
    async fillDisplayName(displayName) {
        console.log('âœï¸  Ø¬Ø§Ø±ÙŠ Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name...');
        
        try {
            await this.page.waitForSelector('input[name="displayName"]', { timeout: 5000 });
            await this.page.type('input[name="displayName"]', displayName, { delay: 50 });
            console.log('âœ… ØªÙ… Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name');
            return true;
        } catch (error) {
            console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Display NameØŒ Ø¬Ø±Ø¨ selectors Ø£Ø®Ø±Ù‰...');
            
            const alternativeSelectors = [
                'input[placeholder*="Display Name" i]',
                'input[placeholder*="Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¶" i]',
                'input[aria-label*="Display Name" i]',
                'input[type="text"][placeholder*="name" i]'
            ];
            
            for (const selector of alternativeSelectors) {
                try {
                    await this.page.type(selector, displayName, { delay: 50 });
                    console.log(`âœ… ØªÙ… Ù…Ù„Ø¡ Display Name Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${selector}`);
                    return true;
                } catch (err) {
                    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£
                }
            }
            
            console.log('âŒ Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name');
            return false;
        }
    }

    // Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
    async fillBirthDate() {
        console.log('ğŸ‚ Ø¬Ø§Ø±ÙŠ Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯...');
        
        try {
            // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡
            await this.page.screenshot({ path: 'before_birthdate.png' });
            console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ù‚Ø¨Ù„ Ù…Ù„Ø¡ Ø§Ù„ØªØ§Ø±ÙŠØ®: before_birthdate.png');
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
            await this.page.evaluate(() => {
                console.log('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®...');
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± select
                const selects = document.querySelectorAll('select');
                console.log(`ğŸ” Ø¹Ø¯Ø¯ Ø­Ù‚ÙˆÙ„ select: ${selects.length}`);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ù„Ø¡ Ø§Ù„Ø´Ù‡Ø±
                const monthSelectors = [
                    'select[aria-label="Month"]',
                    'select[name="birthday_month"]',
                    'select[aria-label*="month" i]',
                    'select[name*="month" i]'
                ];
                
                let monthFilled = false;
                for (const selector of monthSelectors) {
                    const monthSelect = document.querySelector(selector);
                    if (monthSelect) {
                        monthSelect.value = '1'; // ÙŠÙ†Ø§ÙŠØ±
                        monthSelect.dispatchEvent(new Event('change', { bubbles: true }));
                        console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø´Ù‡Ø± Ø¥Ù„Ù‰ 1 (ÙŠÙ†Ø§ÙŠØ±)');
                        monthFilled = true;
                        break;
                    }
                }
                
                if (!monthFilled && selects[0]) {
                    selects[0].value = '1';
                    selects[0].dispatchEvent(new Event('change', { bubbles: true }));
                    console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø´Ù‡Ø± (Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„)');
                }
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ù„Ø¡ Ø§Ù„ÙŠÙˆÙ…
                const daySelectors = [
                    'select[aria-label="Day"]',
                    'select[name="birthday_day"]',
                    'select[aria-label*="day" i]',
                    'select[name*="day" i]'
                ];
                
                let dayFilled = false;
                for (const selector of daySelectors) {
                    const daySelect = document.querySelector(selector);
                    if (daySelect) {
                        daySelect.value = '11'; // Ø§Ù„ÙŠÙˆÙ… 11
                        daySelect.dispatchEvent(new Event('change', { bubbles: true }));
                        console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙŠÙˆÙ… Ø¥Ù„Ù‰ 11');
                        dayFilled = true;
                        break;
                    }
                }
                
                if (!dayFilled && selects[1]) {
                    selects[1].value = '11';
                    selects[1].dispatchEvent(new Event('change', { bubbles: true }));
                    console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙŠÙˆÙ… (Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ)');
                }
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ù„Ø¡ Ø§Ù„Ø³Ù†Ø©
                const yearSelectors = [
                    'select[aria-label="Year"]',
                    'select[name="birthday_year"]',
                    'select[aria-label*="year" i]',
                    'select[name*="year" i]'
                ];
                
                let yearFilled = false;
                for (const selector of yearSelectors) {
                    const yearSelect = document.querySelector(selector);
                    if (yearSelect) {
                        yearSelect.value = '1999'; // Ø³Ù†Ø© 1999
                        yearSelect.dispatchEvent(new Event('change', { bubbles: true }));
                        console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø³Ù†Ø© Ø¥Ù„Ù‰ 1999');
                        yearFilled = true;
                        break;
                    }
                }
                
                if (!yearFilled && selects[2]) {
                    selects[2].value = '1999';
                    selects[2].dispatchEvent(new Event('change', { bubbles: true }));
                    console.log('âœ… ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø³Ù†Ø© (Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«)');
                }
                
                return 'ØªÙ… ØªÙ†ÙÙŠØ° Ø§Ù„ÙƒÙˆØ¯';
            });
            
            await this.randomDelay(1000, 1500);
            
            // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¨Ø¦Ø©
            await this.page.screenshot({ path: 'after_birthdate.png' });
            console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ø¨Ø¹Ø¯ Ù…Ù„Ø¡ Ø§Ù„ØªØ§Ø±ÙŠØ®: after_birthdate.png');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù‚ÙŠÙ… Ù…Ø¶Ø¨ÙˆØ·Ø©
            const birthDateStatus = await this.page.evaluate(() => {
                const results = {};
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ù‡Ø±
                const monthSelect = document.querySelector('select[aria-label="Month"], select[name="birthday_month"]');
                if (monthSelect) {
                    results.month = monthSelect.value;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙŠÙˆÙ…
                const daySelect = document.querySelector('select[aria-label="Day"], select[name="birthday_day"]');
                if (daySelect) {
                    results.day = daySelect.value;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³Ù†Ø©
                const yearSelect = document.querySelector('select[aria-label="Year"], select[name="birthday_year"]');
                if (yearSelect) {
                    results.year = yearSelect.value;
                }
                
                return results;
            });
            
            console.log(`ğŸ“Š Ø­Ø§Ù„Ø© ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:`, birthDateStatus);
            
            if (birthDateStatus.month === '1' && birthDateStatus.day === '11' && birthDateStatus.year === '1999') {
                console.log('âœ… ØªÙ… ØªØ¹Ø¨Ø¦Ø© ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­: 11/01/1999');
                return true;
            } else {
                console.log('âš ï¸  ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ù„Ù… ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                return false;
            }
            
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:', error.message);
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©
            console.log('ğŸ”„ Ø¬Ø±Ø¨ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©...');
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ù‡Ø±
                try {
                    await this.page.select('select[aria-label="Month"]', '1');
                    console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ù‡Ø±: ÙŠÙ†Ø§ÙŠØ± (1)');
                } catch (e) {
                    try {
                        await this.page.select('select[name="birthday_month"]', '1');
                        console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ù‡Ø± Ø¨Ø§Ø³Ù…: ÙŠÙ†Ø§ÙŠØ± (1)');
                    } catch (e2) {
                        console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Ø§Ù„Ø´Ù‡Ø±');
                    }
                }
                
                await this.randomDelay(500, 800);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠÙˆÙ…
                try {
                    await this.page.select('select[aria-label="Day"]', '11');
                    console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠÙˆÙ…: 11');
                } catch (e) {
                    try {
                        await this.page.select('select[name="birthday_day"]', '11');
                        console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ø³Ù…: 11');
                    } catch (e2) {
                        console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Ø§Ù„ÙŠÙˆÙ…');
                    }
                }
                
                await this.randomDelay(500, 800);
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³Ù†Ø©
                try {
                    await this.page.select('select[aria-label="Year"]', '1999');
                    console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³Ù†Ø©: 1999');
                } catch (e) {
                    try {
                        await this.page.select('select[name="birthday_year"]', '1999');
                        console.log('âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³Ù†Ø© Ø¨Ø§Ø³Ù…: 1999');
                    } catch (e2) {
                        console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Ø§Ù„Ø³Ù†Ø©');
                    }
                }
                
                await this.randomDelay(1000, 1500);
                
                // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø´Ø§Ø´Ø© Ø£Ø®ÙŠØ±Ø©
                await this.page.screenshot({ path: 'final_birthdate.png' });
                console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: final_birthdate.png');
                
                console.log('ğŸ¯ ØªÙ…Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹ØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­');
                return true;
                
            } catch (finalError) {
                console.error('âŒ ÙØ´Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª:', finalError.message);
                
                // Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                console.log('\nâš ï¸  âš ï¸  âš ï¸  Ø§Ù†ØªØ¨Ù‡! âš ï¸  âš ï¸  âš ï¸');
                console.log('==================================');
                console.log('Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');
                console.log('ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙŠØ¯ÙˆÙŠØ§Ù‹!');
                console.log('==================================');
                console.log('ğŸ“… Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®:');
                console.log('   Ø§Ù„Ø´Ù‡Ø±: ÙŠÙ†Ø§ÙŠØ± (1)');
                console.log('   Ø§Ù„ÙŠÙˆÙ…: 11');
                console.log('   Ø§Ù„Ø³Ù†Ø©: 1999');
                console.log('==================================');
                console.log('â±ï¸  Ù„Ø¯ÙŠÙƒ 40 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù…Ù„Ø¡ Ø§Ù„ÙŠØ¯ÙˆÙŠ...');
                
                // Ø¹Ø±Ø¶ ØªØ­Ø°ÙŠØ± Ù…Ø±Ø¦ÙŠ
                await this.page.evaluate(() => {
                    const warning = document.createElement('div');
                    warning.style.position = 'fixed';
                    warning.style.top = '10px';
                    warning.style.right = '10px';
                    warning.style.background = 'red';
                    warning.style.color = 'white';
                    warning.style.padding = '20px';
                    warning.style.zIndex = '9999';
                    warning.style.fontSize = '18px';
                    warning.style.borderRadius = '5px';
                    warning.innerHTML = 'âš ï¸ Ø§Ù…Ù„Ø£ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ ÙŠØ¯ÙˆÙŠØ§Ù‹:<br>Ø§Ù„Ø´Ù‡Ø±: 1<br>Ø§Ù„ÙŠÙˆÙ…: 11<br>Ø§Ù„Ø³Ù†Ø©: 1999';
                    document.body.appendChild(warning);
                    
                    setTimeout(() => warning.remove(), 40000);
                });
                
                // Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                await this.page.waitForTimeout(40000);
                
                // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                await this.page.screenshot({ path: 'manual_fill_complete.png' });
                console.log('ğŸ“¸ ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø© Ø§Ù„Ø´Ø§Ø´Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±: manual_fill_complete.png');
                
                return false;
            }
        }
    }

    // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Create Account
    async clickCreateAccountButton() {
        console.log('ğŸ–±ï¸  Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± Create Account...');
        
        try {
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± Submit
            await this.page.click('button[type="submit"]');
            console.log('âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Submit');
            return true;
        } catch (error) {
            console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø²Ø± Submit Ù…Ø¨Ø§Ø´Ø±');
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø²Ø±Ø§Ø± Ø£Ø®Ø±Ù‰
        const buttonSelectors = [
            'button[type="submit"]',
            'button:has-text("Create Account")',
            'button:has-text("Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨")',
            'button[aria-label*="Create Account"]',
            'button[class*="button"][type="button"]'
        ];
        
        for (const selector of buttonSelectors) {
            try {
                const buttons = await this.page.$$(selector);
                if (buttons.length > 0) {
                    await buttons[0].click();
                    console.log(`âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${selector}`);
                    return true;
                }
            } catch (error) {
                // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£
            }
        }
        
        console.log('âŒ Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account');
        return false;
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†
    async getDiscordToken() {
        try {
            return await this.page.evaluate(() => {
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ localStorage
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    if (value && value.includes('.')) {
                        return value;
                    }
                }

                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ cookies
                const cookies = document.cookie.split(';');
                for (const cookie of cookies) {
                    const [name, value] = cookie.trim().split('=');
                    if (name && value && value.includes('.')) {
                        return value;
                    }
                }

                return null;
            });
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†:', error.message);
            return null;
        }
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙˆØ§Ø­Ø¯
    async createSingleAccount() {
        try {
            console.log('\nğŸ“ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª...');

            // Ù‚Ø±Ø§Ø¡Ø© Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† ÙƒÙ„ Ù…Ù„Ù
            const email = await this.readFirstLine('gmails.txt');
            const displayName = await this.readFirstLine('names.txt');
            const username = await this.readFirstLine('username.txt');
            const password = await this.readFirstLine('password.txt');

            if (!email || !displayName || !username || !password) {
                console.error('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª!');
                return false;
            }

            console.log(`
ğŸ“§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„: ${email}
ğŸ‘¤ Display Name: ${displayName}
ğŸ”¤ Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…: ${username}
ğŸ” Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯: ${password}
            `);

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            console.log('ğŸŒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Discord...');
            await this.page.goto('https://discord.com/register', { 
                waitUntil: 'networkidle2',
                timeout: 30000
            });
            
            await this.randomDelay(2000, 3000);

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙØ­Ø©
            const pageUrl = await this.page.url();
            console.log(`ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ: ${pageUrl}`);

            // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø£ÙˆÙ„ÙŠØ©
            await this.page.screenshot({ path: 'initial_page.png' });
            console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: initial_page.png');

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„...');
            try {
                await this.page.waitForSelector('input[name="email"]', { timeout: 10000 });
                await this.page.type('input[name="email"]', email, { delay: 50 });
                console.log('âœ… ØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„');
            } catch (error) {
                console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø¬Ø±Ø¨ selectors Ø£Ø®Ø±Ù‰...');
                
                const emailSelectors = [
                    'input[type="email"]',
                    'input[placeholder*="email" i]',
                    'input[placeholder*="Ø¨Ø±ÙŠØ¯" i]',
                    'input[aria-label*="email" i]'
                ];
                
                for (const selector of emailSelectors) {
                    try {
                        await this.page.type(selector, email, { delay: 50 });
                        console.log(`âœ… ØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${selector}`);
                        break;
                    } catch (err) {}
                }
            }
            
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name
            await this.fillDisplayName(displayName);
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Username
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Username...');
            try {
                await this.page.waitForSelector('input[name="username"]', { timeout: 5000 });
                await this.page.type('input[name="username"]', username, { delay: 50 });
                console.log('âœ… ØªÙ… Ù…Ù„Ø¡ Username');
            } catch (error) {
                console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Username Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø¬Ø±Ø¨ selectors Ø£Ø®Ø±Ù‰...');
                
                const usernameSelectors = [
                    'input[placeholder*="username" i]',
                    'input[placeholder*="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" i]',
                    'input[aria-label*="username" i]'
                ];
                
                for (const selector of usernameSelectors) {
                    try {
                        await this.page.type(selector, username, { delay: 50 });
                        console.log(`âœ… ØªÙ… Ù…Ù„Ø¡ Username Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${selector}`);
                        break;
                    } catch (err) {}
                }
            }
            
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Password
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Password...');
            try {
                await this.page.waitForSelector('input[name="password"]', { timeout: 5000 });
                await this.page.type('input[name="password"]', password, { delay: 50 });
                console.log('âœ… ØªÙ… Ù…Ù„Ø¡ Password');
            } catch (error) {
                console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ø­Ù‚Ù„ Password Ø¨Ø§Ù„Ø§Ø³Ù…ØŒ Ø¬Ø±Ø¨ selectors Ø£Ø®Ø±Ù‰...');
                
                const passwordSelectors = [
                    'input[type="password"]',
                    'input[placeholder*="password" i]',
                    'input[placeholder*="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" i]',
                    'input[aria-label*="password" i]'
                ];
                
                for (const selector of passwordSelectors) {
                    try {
                        await this.page.type(selector, password, { delay: 50 });
                        console.log(`âœ… ØªÙ… Ù…Ù„Ø¡ Password Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${selector}`);
                        break;
                    } catch (err) {}
                }
            }
            
            await this.randomDelay(1000, 1500);

            // Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯
            console.log('\nğŸ¯ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯...');
            await this.fillBirthDate();
            
            // Ø§Ù„ØªÙ‚Ø§Ø· screenshot Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø±
            await this.page.screenshot({ path: 'before_click.png' });
            console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Create Account: before_click.png');

            // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Create Account
            console.log('\nğŸ¯ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account...');
            const clicked = await this.clickCreateAccountButton();
            
            if (!clicked) {
                console.log('âš ï¸  ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account ÙŠØ¯ÙˆÙŠØ§Ù‹');
                console.log('â±ï¸  Ø§Ù†ØªØ¸Ø§Ø± 10 Ø«ÙˆØ§Ù†Ù...');
                await this.page.waitForTimeout(10000);
            }

            // Ø§Ù„ØªÙ‚Ø§Ø· screenshot Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø±
            await this.page.screenshot({ path: 'after_click.png' });
            console.log('ğŸ“¸ Ù„Ù‚Ø·Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Ø±: after_click.png');

            // Ø§Ù†ØªØ¸Ø§Ø±
            console.log('â³ Ø§Ù†ØªØ¸Ø§Ø± 5 Ø«ÙˆØ§Ù†Ù...');
            await this.page.waitForTimeout(5000);

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†
            console.log('ğŸ”‘ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†...');
            const token = await this.getDiscordToken();
            
            if (token) {
                console.log('âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†!');
                console.log(`ğŸ” Ø§Ù„ØªÙˆÙƒÙ†: ${token.substring(0, 30)}...`);
                
                // Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ†
                await fs.appendFile('tokens.txt', `${token}\n`);
                console.log('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ tokens.txt');
                
                // Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('ğŸ—‘ï¸  ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©');
                return token;
            } else {
                console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†');
                
                // Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('ğŸ—‘ï¸  ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©');
                return false;
            }

        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨:', error.message);
            // Ø§Ù„ØªÙ‚Ø§Ø· Ù„Ù‚Ø·Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£
            await this.page.screenshot({ path: 'error.png' });
            console.log('ğŸ“¸ ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø© Ø§Ù„Ø®Ø·Ø£: error.png');
            return false;
        }
    }

    async run() {
        console.log(`
==========================================
 Discord Account Creator
==========================================
ğŸ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ø«Ø§Ø¨Øª: 11 ÙŠÙ†Ø§ÙŠØ± 1999
        `);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
        const requiredFiles = ['gmails.txt', 'names.txt', 'username.txt', 'password.txt'];
        for (const file of requiredFiles) {
            if (!fsSync.existsSync(file)) {
                console.error(`âŒ Ù…Ù„Ù ${file} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!`);
                console.log(`ğŸ“ Ø£Ù†Ø´Ø¦ Ù…Ù„Ù ${file} ÙˆØ¶Ø¹ ÙÙŠÙ‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`);
                return;
            }
        }

        try {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØªØµÙØ­...');
            
            this.browser = await puppeteer.launch({ 
                headless: false,
                defaultViewport: null,
                args: ['--start-maximized', '--no-sandbox', '--disable-blink-features=AutomationControlled']
            });
            
            this.page = await this.browser.newPage();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø£Ù†Ù‡ ÙŠØªÙ… Ø§Ù„ØªØ­ÙƒÙ… Ø¢Ù„ÙŠØ§Ù‹
            await this.page.evaluateOnNewDocument(() => {
                Object.defineProperty(navigator, 'webdriver', {
                    get: () => false
                });
            });
            
            await this.page.setUserAgent(
                'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
            );

            console.log('âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­');
            console.log('ğŸ¯ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨...\n');

            const token = await this.createSingleAccount();
            
            if (token) {
                console.log('\nâœ¨ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! âœ¨');
            } else {
                console.log('\nâš ï¸  Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§ÙƒØªÙ…Ù„Øª Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„');
                console.log('ğŸ“¸ ØªÙ… Ø­ÙØ¸ Ù„Ù‚Ø·Ø§Øª Ø´Ø§Ø´Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ´Ø®ÙŠØµ');
            }

        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:', error.message);
        } finally {
            console.log('\nâ³ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù...');
            await this.page.waitForTimeout(3000);
            
            if (this.browser) {
                await this.browser.close();
                console.log('âœ… ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­');
            }
            
            console.log('\nğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:');
            console.log('   1. ØªÙ… Ø­ÙØ¸ Ø¹Ø¯Ø© Ù„Ù‚Ø·Ø§Øª Ø´Ø§Ø´Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©');
            console.log('   2. Ø¥Ø°Ø§ Ù„Ù… ÙŠÙ…Ù„Ø£ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ ÙŠØ¬Ø¨ Ù…Ù„Ø¤Ù‡ ÙŠØ¯ÙˆÙŠØ§Ù‹');
            console.log('   3. Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: 11 ÙŠÙ†Ø§ÙŠØ± 1999');
            console.log('   4. ØªÙˆÙƒÙ†Ø§Øª Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ tokens.txt');
        }
    }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
(async () => {
    const creator = new DiscordAccountCreator();
    await creator.run();
})();