<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>برمجة هندسية لصناعة المواقع</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

    body {
        font-family: 'Cairo', sans-serif;
        background-color: #000000;
        color: white;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        flex: 1;
    }

    .main-title {
        text-align: center;
        font-size: 2.5em;
        font-weight: 700;
        margin-bottom: 50px;
        text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.3);
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .main-title:hover {
        transform: scale(1.05);
        text-shadow: 3px 3px 8px rgba(255, 255, 255, 0.5);
    }

    .main-title:active {
        transform: scale(0.98);
    }

    .cards-container {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        justify-content: center;
        margin-bottom: 50px;
    }

    .card {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        border-radius: 15px;
        padding: 30px;
        width: 350px;
        text-align: center;
        box-shadow: 0 10px 30px rgba(255, 255, 255, 0.1);
        border: 1px solid #333;
        transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s;
    }

    .card:hover::before {
        left: 100%;
    }

    .card:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: 0 20px 50px rgba(255, 255, 255, 0.2);
        border-color: #555;
    }

    .card:active {
        transform: translateY(-8px) scale(0.98);
    }

    .student-name {
        font-size: 1.5em;
        font-weight: 600;
        margin-bottom: 20px;
        color: #ffffff;
        transition: all 0.3s ease;
    }

    .card:hover .student-name {
        color: #4CAF50;
        transform: translateY(-2px);
    }

    .buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
    }

    .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-family: 'Cairo', sans-serif;
        font-weight: 600;
        font-size: 14px;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        text-decoration: none;
        display: inline-block;
        position: relative;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
    }

    .btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transition: all 0.6s ease;
        transform: translate(-50%, -50%);
    }

    .btn:active::before {
        width: 300px;
        height: 300px;
    }

    .btn:active {
        transform: scale(0.95);
    }

    .btn-details {
        background: linear-gradient(45deg, #4CAF50, #45a049, #66BB6A);
        color: white;
        background-size: 200% 200%;
        animation: gradientShift 3s ease infinite;
    }

    .btn-details:hover {
        background: linear-gradient(45deg, #45a049, #3d8b40, #4CAF50);
        transform: scale(1.08) rotateZ(2deg);
        box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
    }

    .btn-vote {
        background: linear-gradient(45deg, #2196F3, #1976D2, #42A5F5);
        color: white;
        background-size: 200% 200%;
        animation: gradientShift 3s ease infinite;
    }

    .btn-vote:hover {
        background: linear-gradient(45deg, #1976D2, #1565C0, #2196F3);
        transform: scale(1.08) rotateZ(-2deg);
        box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4);
    }

    .btn-vote:disabled {
        background: linear-gradient(45deg, #666, #555, #777);
        cursor: not-allowed;
        transform: none;
        animation: none;
    }

    .btn-vote:disabled:hover {
        transform: none;
        box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
    }

    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .footer {
        text-align: center;
        padding: 20px;
        border-top: 1px solid #333;
        margin-top: 50px;
        font-size: 14px;
        color: #ccc;
    }

    .details-page {
        display: none;
        text-align: center;
    }

    .details-title {
        font-size: 2em;
        margin-bottom: 40px;
    }

    .details-info {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        border-radius: 15px;
        padding: 40px;
        margin: 0 auto 40px;
        max-width: 500px;
        border: 1px solid #333;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }

    .details-info::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.05), transparent);
        transform: rotate(45deg);
        transition: all 0.6s ease;
    }

    .details-info:hover::before {
        transform: rotate(45deg) translate(100%, 100%);
    }

    .details-info:hover {
        transform: scale(1.02);
        box-shadow: 0 15px 40px rgba(255, 255, 255, 0.15);
    }

    .info-item {
        font-size: 1.2em;
        margin-bottom: 15px;
        padding: 10px;
        border-bottom: 1px solid #333;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .info-item:hover {
        background: rgba(255, 255, 255, 0.05);
        transform: translateX(10px);
        border-radius: 8px;
    }

    .info-item:last-child {
        border-bottom: none;
    }

    .back-btn {
        background: linear-gradient(45deg, #FF9800, #F57C00, #FFB74D);
        color: white;
        padding: 12px 30px;
        margin-top: 20px;
        background-size: 200% 200%;
        animation: gradientShift 3s ease infinite;
    }

    .back-btn:hover {
        background: linear-gradient(45deg, #F57C00, #E65100, #FF9800);
        transform: scale(1.08) rotateZ(1deg);
        box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
    }

    .votes-count {
        color: #4CAF50;
        font-weight: 700;
    }

    .message {
        text-align: center;
        padding: 15px;
        margin: 20px 0;
        border-radius: 10px;
        display: none;
    }

    .message.success {
        background: rgba(76, 175, 80, 0.2);
        border: 1px solid #4CAF50;
        color: #4CAF50;
    }

    .message.error {
        background: rgba(244, 67, 54, 0.2);
        border: 1px solid #f44336;
        color: #f44336;
    }

    @media (max-width: 768px) {
        .cards-container {
            flex-direction: column;
            align-items: center;
        }

        .card {
            width: 90%;
            max-width: 350px;
        }

        .main-title {
            font-size: 2em;
        }

        .buttons {
            flex-direction: column;
            gap: 10px;
        }
    }
</style>

</head>
<body>
    <div class="container">
        <!-- الصفحة الرئيسية -->
        <div id="main-page">
            <h1 class="main-title">برمجة هندسية لصناعة المواقع</h1>

        <div id="message" class="message"></div>
        
        <div class="cards-container">
            <div class="card">
                <div class="student-name">Youssef Sabah | يوسف صباح</div>
                <div class="buttons">
                    <button class="btn btn-details" onclick="showDetails('youssef')">التفاصيل</button>
                    <button class="btn btn-vote" onclick="vote('youssef')">التصويت</button>
                </div>
            </div>

            <div class="card">
                <div class="student-name">Shafak Al-Badawi | شفق البدوي</div>
                <div class="buttons">
                    <button class="btn btn-details" onclick="showDetails('shafak')">التفاصيل</button>
                    <button class="btn btn-vote" onclick="vote('shafak')">التصويت</button>
                </div>
            </div>

            <div class="card">
                <div class="student-name">Ali Al-Rimawi | علي الريماوي</div>
                <div class="buttons">
                    <button class="btn btn-details" onclick="showDetails('ali')">التفاصيل</button>
                    <button class="btn btn-vote" onclick="vote('ali')">التصويت</button>
                </div>
            </div>
        </div>
    </div>

    <!-- صفحة تفاصيل يوسف -->
    <div id="youssef-details" class="details-page">
        <h1 class="details-title">تفاصيل المرشح</h1>
        <div class="details-info">
            <div class="info-item"><strong>الاسم:</strong> يوسف صباح</div>
            <div class="info-item"><strong>العمر:</strong> 14 عام</div>
            <div class="info-item"><strong>البلد:</strong> الأردن</div>
            <div class="info-item"><strong>طالب في:</strong> مدرسة الرأي</div>
            <div class="info-item"><strong>عدد الأصوات:</strong> <span class="votes-count" id="youssef-votes">0</span></div>
        </div>
        <button class="btn back-btn" onclick="showMain()">رجوع</button>
    </div>

    <!-- صفحة تفاصيل شفق -->
    <div id="shafak-details" class="details-page">
        <h1 class="details-title">تفاصيل المرشح</h1>
        <div class="details-info">
            <div class="info-item"><strong>الاسم:</strong> شفق البدوي</div>
            <div class="info-item"><strong>العمر:</strong> 14 عام</div>
            <div class="info-item"><strong>البلد:</strong> الأردن</div>
            <div class="info-item"><strong>طالب في:</strong> مدرسة الرأي</div>
            <div class="info-item"><strong>عدد الأصوات:</strong> <span class="votes-count" id="shafak-votes">0</span></div>
        </div>
        <button class="btn back-btn" onclick="showMain()">العودة للقائمة الرئيسية</button>
    </div>

    <!-- صفحة تفاصيل علي -->
    <div id="ali-details" class="details-page">
        <h1 class="details-title">تفاصيل المرشح</h1>
        <div class="details-info">
            <div class="info-item"><strong>الاسم:</strong> علي الريماوي</div>
            <div class="info-item"><strong>العمر:</strong> 14 عام</div>
            <div class="info-item"><strong>البلد:</strong> الأردن</div>
            <div class="info-item"><strong>طالب في:</strong> مدرسة الرأي</div>
            <div class="info-item"><strong>عدد الأصوات:</strong> <span class="votes-count" id="ali-votes">0</span></div>
        </div>
        <button class="btn back-btn" onclick="showMain()">العودة للقائمة الرئيسية</button>
    </div>
</div>

<footer class="footer">
    جميع الحقوق محفوظة للمبرمج: سومر خضر عمر أبو عبد الله<br>
    مصنوع للطالب: يوسف الصف التاسع د
</footer>

<script>
    // الملف المشترك للجميع
    const VOTING_FILE = 'voting_results';
    
    // بيانات التصويت
    let votingData = {
        votes: { youssef: 0, shafak: 0, ali: 0 },
        users: {}  // قائمة المستخدمين ومن صوتوا له
    };
    
    let currentUser = null;
    let hasVoted = false;

    // إنشاء معرف للمستخدم أو استرجاعه
    function initUser() {
        currentUser = localStorage.getItem('userId');
        if (!currentUser) {
            // إنشاء معرف جديد
            currentUser = 'user_' + new Date().getTime() + '_' + Math.floor(Math.random() * 1000);
            localStorage.setItem('userId', currentUser);
            console.log('مستخدم جديد تم إنشاؤه:', currentUser);
        } else {
            console.log('مستخدم موجود:', currentUser);
        }
    }

    // قراءة البيانات من الملف المشترك
    function loadFromFile() {
        try {
            const savedData = localStorage.getItem(VOTING_FILE);
            if (savedData) {
                const parsed = JSON.parse(savedData);
                votingData.votes = parsed.votes || { youssef: 0, shafak: 0, ali: 0 };
                votingData.users = parsed.users || {};
                console.log('تم تحميل البيانات:', votingData);
            } else {
                console.log('لا توجد بيانات سابقة - بداية جديدة');
            }
        } catch (error) {
            console.log('خطأ في قراءة الملف');
            votingData = {
                votes: { youssef: 0, shafak: 0, ali: 0 },
                users: {}
            };
        }
    }

    // حفظ البيانات في الملف المشترك
    function saveToFile() {
        try {
            localStorage.setItem(VOTING_FILE, JSON.stringify(votingData));
            console.log('تم حفظ البيانات:', votingData);
            return true;
        } catch (error) {
            console.log('خطأ في حفظ البيانات');
            return false;
        }
    }

    // فحص إذا كان المستخدم صوت من قبل
    function checkIfUserVoted() {
        if (votingData.users[currentUser]) {
            hasVoted = true;
            console.log('المستخدم صوت من قبل لـ:', votingData.users[currentUser]);
            return true;
        }
        hasVoted = false;
        console.log('المستخدم لم يصوت من قبل');
        return false;
    }

    // تحديث عرض الأصوات
    function updateDisplay() {
        document.getElementById('youssef-votes').textContent = votingData.votes.youssef;
        document.getElementById('shafak-votes').textContent = votingData.votes.shafak;
        document.getElementById('ali-votes').textContent = votingData.votes.ali;

        // تعطيل أزرار التصويت إذا كان المستخدم صوت
        if (hasVoted) {
            const buttons = document.querySelectorAll('.btn-vote');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.textContent = 'تم التصويت';
                btn.style.opacity = '0.5';
            });
        }
    }

    // التصويت
    function vote(candidate) {
        console.log('محاولة تصويت من:', currentUser, 'لـ:', candidate);
        
        if (hasVoted) {
            showMessage('لقد صوتت مسبقاً! لا يمكن التصويت مرة أخرى.', 'error');
            return;
        }

        // إضافة الصوت
        votingData.votes[candidate]++;
        
        // تسجيل المستخدم
        votingData.users[currentUser] = candidate;
        
        // حفظ في الملف
        if (saveToFile()) {
            hasVoted = true;
            updateDisplay();
            
            let name = '';
            if (candidate === 'youssef') name = 'يوسف صباح';
            if (candidate === 'shafak') name = 'شفق البدوي';  
            if (candidate === 'ali') name = 'علي الريماوي';
            
            showMessage(`تم التصويت لـ ${name} بنجاح!`, 'success');
            console.log('تم التصويت بنجاح');
        } else {
            showMessage('حدث خطأ، يرجى المحاولة مرة أخرى', 'error');
        }
    }

    // تحميل البيانات الكامل
    function loadAllData() {
        initUser();           // إنشاء أو استرجاع معرف المستخدم
        loadFromFile();       // قراءة البيانات من الملف
        checkIfUserVoted();   // فحص إذا كان المستخدم صوت
        updateDisplay();      // تحديث العرض
    }

    // عرض الصفحة الرئيسية
    function showMain() {
        loadAllData(); // إعادة تحميل البيانات
        document.getElementById('main-page').style.display = 'block';
        document.querySelectorAll('.details-page').forEach(page => {
            page.style.display = 'none';
            page.classList.remove('show');
        });
    }

    // عرض تفاصيل المرشح
    function showDetails(candidate) {
        loadAllData(); // إعادة تحميل البيانات
        document.getElementById('main-page').style.display = 'none';
        document.querySelectorAll('.details-page').forEach(page => {
            page.style.display = 'none';
            page.classList.remove('show');
        });
        
        const detailsPage = document.getElementById(candidate + '-details');
        detailsPage.style.display = 'block';
        
        setTimeout(() => {
            detailsPage.classList.add('show');
        }, 50);
    }

    // عرض الرسائل
    function showMessage(text, type) {
        const messageDiv = document.getElementById('message');
        messageDiv.textContent = text;
        messageDiv.className = `message ${type}`;
        messageDiv.style.display = 'block';
        
        setTimeout(() => {
            messageDiv.style.display = 'none';
        }, 5000);
    }

    // تحديث دوري كل 3 ثوانِ
    setInterval(() => {
        const oldVotes = JSON.stringify(votingData.votes);
        loadFromFile();
        const newVotes = JSON.stringify(votingData.votes);
        
        if (oldVotes !== newVotes) {
            updateDisplay();
            console.log('تم تحديث الأصوات تلقائياً');
        }
    }, 3000);

    // بدء تشغيل الموقع
    window.onload = function() {
        console.log('=== بدء تشغيل موقع التصويت ===');
        loadAllData();
        showMain();
        
        // عرض معلومات التشغيل
        console.log('المستخدم الحالي:', currentUser);
        console.log('حالة التصويت:', hasVoted ? 'صوت مسبقاً' : 'لم يصوت');
        console.log('إجمالي الأصوات:', votingData.votes);
        console.log('عدد المصوتين:', Object.keys(votingData.users).length);
    };
</script>

</body>
</html>