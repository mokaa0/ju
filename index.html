from PyQt5 import QtWidgets, QtCore
import sys
import requests
import threading

# بيانات VPS HTTP API - غيرها حسب عندك
VPS_URL = "https://VPS_IP:5000/upload_tokens"  # غيرها لـ ip و port الصحيح

class MainWindow(QtWidgets.QWidget):
    def __init__(self):
        super().__init__()
        self.setWindowTitle("2050 - Discord Tool")
        self.setGeometry(300, 200, 600, 500)
        self.setStyleSheet("background-color: black;")
        layout = QtWidgets.QVBoxLayout()

        title = QtWidgets.QLabel("2050")
        title.setStyleSheet("font-size: 60px; font-weight: bold; color: limegreen;")
        title.setAlignment(QtCore.Qt.AlignLeft)
        layout.addWidget(title)

        subtitle = QtWidgets.QLabel("2050 - Online accounts")
        subtitle.setStyleSheet("color: lightblue; font-size: 18px;")
        layout.addWidget(subtitle)

        dev = QtWidgets.QLabel("Developed by .884.  |  Random Status")
        dev.setStyleSheet("color: yellow;")
        layout.addWidget(dev)

        self.log_label = QtWidgets.QLabel("Loading Tool ..")
        self.log_label.setStyleSheet("color: limegreen; font-size: 16px;")
        layout.addWidget(self.log_label)

        self.token_box = QtWidgets.QPlainTextEdit()
        self.token_box.setPlaceholderText("[+] tokens : up to 200 tokens, one per line")
        self.token_box.setStyleSheet("background-color: #222; color: white;")
        layout.addWidget(self.token_box)

        self.start_btn = QtWidgets.QPushButton("Start")
        self.start_btn.setStyleSheet("background-color: green; color: white; font-size: 18px;")
        self.start_btn.clicked.connect(self.start_tool)
        layout.addWidget(self.start_btn)

        self.status_output = QtWidgets.QTextEdit()
        self.status_output.setReadOnly(True)
        self.status_output.setStyleSheet("background-color: #111; color: white;")
        layout.addWidget(self.status_output)

        self.setLayout(layout)

    def log(self, msg, color="white"):
        self.status_output.append(f"<span style='color:{color}'>{msg}</span>")

    def start_tool(self):
        tokens = self.token_box.toPlainText().splitlines()
        tokens = [t.strip() for t in tokens if t.strip()]
        if len(tokens) > 200:
            self.log("⚠️ Max 200 tokens only.", "red")
            return

        self.log("Uploading tokens to VPS...", "yellow")

        threading.Thread(target=self.upload_tokens_http, args=(tokens,), daemon=True).start()

    def upload_tokens_http(self, tokens):
        try:
            response = requests.post(VPS_URL, json={"tokens": tokens}, verify=False)
            res = response.json()
            if res.get("status") == "success":
                self.log("Tokens uploaded and runner started.", "green")
            else:
                self.log(f"Error from server: {res.get('message')}", "red")
        except Exception as e:
            self.log(f"Connection error: {str(e)}", "red")


def run_gui():
    app = QtWidgets.QApplication(sys.argv)
    window = MainWindow()
    window.show()
    sys.exit(app.exec_())


if __name__ == "__main__":
    run_gui()