// fast-send.js
const fs = require('fs');
const { Client } = require('discord.js-selfbot-v13'); // npm i discord.js-selfbot-v13

// قراءة الرسائل
const messages = fs.readFileSync('message.txt', 'utf-8').split('\n').filter(line => line.trim() !== '');
const accounts = fs.readFileSync('tokens.txt', 'utf-8')
    .split('\n')
    .map(line => line.trim())
    .filter(line => line && line.includes('|'))
    .map(line => {
        const [token, channelId] = line.split('|').map(v => v.trim());
        return { token, channelId };
    });

accounts.forEach(({ token, channelId }) => {
    const client = new Client({ checkUpdate: false });

    client.on('ready', async () => {
        console.log(`✅ Logged in as ${client.user.tag} - Channel: ${channelId}`);

        const channel = await client.channels.fetch(channelId).catch(() => null);
        if (!channel) {
            console.log(`❌ Couldn't find channel for token: ${token}`);
            return;
        }

        // دالة الإرسال السريع
        const spam = async () => {
            while (true) {
                for (let i = 0; i < 50; i++) { // يرسل 50 رسالة دفعة واحدة
                    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                    channel.send(randomMessage).catch(err => {
                        if (err.message.includes('rate limited')) {
                            console.log(`⚠️ Rate limited for ${client.user.tag}, waiting...`);
                        }
                    });
                }
                await new Promise(res => setTimeout(res, 1000)); // ينتظر ثانية ويعيد
            }
        };

        spam();
    });

    client.login(token).catch(() => console.log(`❌ Failed to login with token: ${token}`));
});