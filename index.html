const puppeteer = require('puppeteer');
const fs = require('fs').promises;
const fsSync = require('fs');

class DiscordAccountCreator {
    constructor() {
        this.browser = null;
        this.page = null;
    }

    // ูุฑุงุกุฉ ุฃูู ุณุทุฑ ูู ุงูููู
    async readFirstLine(filename) {
        try {
            if (!fsSync.existsSync(filename)) {
                console.error(`โ ููู ${filename} ุบูุฑ ููุฌูุฏ!`);
                return null;
            }
            
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            return lines.length > 0 ? lines[0].trim() : null;
        } catch (error) {
            console.error(`โ ุฎุทุฃ ูู ูุฑุงุกุฉ ${filename}:`, error.message);
            return null;
        }
    }

    // ุญุฐู ุฃูู ุณุทุฑ ูู ุงูููู
    async deleteFirstLine(filename) {
        try {
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length > 0) {
                const newContent = lines.slice(1).join('\n');
                await fs.writeFile(filename, newContent);
                console.log(`โ ุญุฐู ุฃูู ุณุทุฑ ูู ${filename}`);
                return true;
            }
            return false;
        } catch (error) {
            console.error(`โ ุฎุทุฃ ูู ุญุฐู ุงูุณุทุฑ ูู ${filename}:`, error.message);
            return false;
        }
    }

    // ุชูููุฏ ุชุงุฑูุฎ (23/9/1980) ูุน ุชุบููุฑุงุช ุนุดูุงุฆูุฉ ูู ุงูููู
    generateDate() {
        const baseDay = 23;
        const baseMonth = 9; // ุณุจุชูุจุฑ
        const baseYear = 1980; // ุชู ุงูุชุบููุฑ ูู 2002 ุฅูู 1980
        
        // ุชุบููุฑ ุงูููู ุจุดูู ุนุดูุงุฆู ุจูู 1-28 (ูุชูุงุฏููุง ููุงูุฉ ุงูุดูุฑ)
        const dayVariations = [21, 22, 23, 24, 25, 26, 27, 28, 15, 16, 17, 18, 19, 20];
        const randomDay = dayVariations[Math.floor(Math.random() * dayVariations.length)];
        
        return {
            month: baseMonth.toString(),
            day: randomDay.toString(),
            year: baseYear.toString()
        };
    }

    // ุงูุชุธุงุฑ ุนุดูุงุฆู
    async randomDelay(min = 500, max = 1000) {
        const delay = Math.floor(Math.random() * (max - min + 1)) + min;
        await this.page.waitForTimeout(delay);
    }

    // ุงูุจุญุซ ุนู ุนูุตุฑ ุจุทุฑู ูุฎุชููุฉ
    async findElement(selectors) {
        for (const selector of selectors) {
            try {
                const element = await this.page.$(selector);
                if (element) {
                    console.log(`โ ูุฌุฏุช ุงูุนูุตุฑ ุจุงุณุชุฎุฏุงู: ${selector}`);
                    return element;
                }
            } catch (error) {
                // ุชุฌุงูู ุงูุฎุทุฃ ูุฌุฑุจ selector ุงูุชุงูู
            }
        }
        return null;
    }

    // ููุก ุชุงุฑูุฎ ุงููููุงุฏ (23/9/1980 ูุน ุชุบููุฑุงุช ูู ุงูููู)
    async fillBirthDate(birthDate) {
        console.log('๐ ุฌุงุฑู ููุก ุชุงุฑูุฎ ุงููููุงุฏ...');
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Month
        const monthSelectors = [
            'select[aria-label="Month"]',
            'select[name="birthday_month"]',
            'select[id="birthdayMonth"]',
            'select.monthSelect-2k6U8R',
            'select[class*="month"]',
            'select:nth-of-type(1)',
            'div[aria-label="Month"] select',
            '.birthdayPicker-3CcooJ select:first-child'
        ];
        
        const monthSelect = await this.findElement(monthSelectors);
        if (monthSelect) {
            await monthSelect.select(birthDate.month);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูุดูุฑ: ุณุจุชูุจุฑ (${birthDate.month})`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงูุดูุฑุ ุฃุฌุฑุจ ุทุฑูุงู ุฃุฎุฑู...');
            
            // ูุญุงููุฉ ุงูููุฑ ุนูู ุงููุงุฆูุฉ ุฃููุงู ุซู ุงูุงุฎุชูุงุฑ
            try {
                await this.page.click('div[aria-label="Month"]');
                await this.randomDelay(300, 500);
                
                // ูุญุงููุฉ ุงุฎุชูุงุฑ ุณุจุชูุจุฑ
                await this.page.keyboard.type('September');
                await this.randomDelay(300, 500);
                await this.page.keyboard.press('Enter');
                console.log('โ ุงุฎุชูุงุฑ ุงูุดูุฑ ุนู ุทุฑูู ุงููุชุงุจุฉ');
            } catch (error) {
                console.log('โ ูุดู ุงุฎุชูุงุฑ ุงูุดูุฑ');
            }
        }
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Day
        const daySelectors = [
            'select[aria-label="Day"]',
            'select[name="birthday_day"]',
            'select[id="birthdayDay"]',
            'select.daySelect-3mOPM3',
            'select[class*="day"]',
            'select:nth-of-type(2)',
            'div[aria-label="Day"] select',
            '.birthdayPicker-3CcooJ select:nth-child(2)'
        ];
        
        const daySelect = await this.findElement(daySelectors);
        if (daySelect) {
            await daySelect.select(birthDate.day);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูููู: ${birthDate.day}`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงููููุ ุฃุฌุฑุจ ุทุฑูุงู ุฃุฎุฑู...');
            
            try {
                await this.page.click('div[aria-label="Day"]');
                await this.randomDelay(300, 500);
                
                await this.page.keyboard.type(birthDate.day);
                await this.randomDelay(300, 500);
                await this.page.keyboard.press('Enter');
                console.log(`โ ุงุฎุชูุงุฑ ุงูููู ุนู ุทุฑูู ุงููุชุงุจุฉ: ${birthDate.day}`);
            } catch (error) {
                console.log('โ ูุดู ุงุฎุชูุงุฑ ุงูููู');
            }
        }
        
        // ูุญุงููุงุช ูุฎุชููุฉ ูู Year
        const yearSelectors = [
            'select[aria-label="Year"]',
            'select[name="birthday_year"]',
            'select[id="birthdayYear"]',
            'select.yearSelect-2MGqHb',
            'select[class*="year"]',
            'select:nth-of-type(3)',
            'div[aria-label="Year"] select',
            '.birthdayPicker-3CcooJ select:nth-child(3)'
        ];
        
        const yearSelect = await this.findElement(yearSelectors);
        if (yearSelect) {
            await yearSelect.select(birthDate.year);
            console.log(`โ ุชู ุงุฎุชูุงุฑ ุงูุณูุฉ: ${birthDate.year}`);
            await this.randomDelay(300, 500);
        } else {
            console.log('โ๏ธ  ูู ุฃุฌุฏ ูุงุฆูุฉ ุงุฎุชูุงุฑ ุงูุณูุฉุ ุฃุฌุฑุจ ุทุฑูุงู ุฃุฎุฑู...');
            
            try {
                await this.page.click('div[aria-label="Year"]');
                await this.randomDelay(300, 500);
                
                await this.page.keyboard.type(birthDate.year);
                await this.randomDelay(300, 500);
                await this.page.keyboard.press('Enter');
                console.log(`โ ุงุฎุชูุงุฑ ุงูุณูุฉ ุนู ุทุฑูู ุงููุชุงุจุฉ: ${birthDate.year}`);
            } catch (error) {
                console.log('โ ูุดู ุงุฎุชูุงุฑ ุงูุณูุฉ');
            }
        }
        
        console.log(`๐ ุชุงุฑูุฎ ุงููููุงุฏ: ุณุจุชูุจุฑ/${birthDate.day}/1980`);
    }

    // ุงูุถุบุท ุนูู ุฒุฑ Create Account ูุจุงุดุฑุฉ
    async clickCreateAccountButton() {
        console.log('๐ฑ๏ธ  ุฌุงุฑู ุงูููุฑ ุนูู ุฒุฑ Create Account...');
        
        // ูุงุฆูุฉ ุจุฌููุน ุงูุฃุฒุฑุงุฑ ุงููุญุชููุฉ ูุฒุฑ ุงูุฅูุดุงุก
        const buttonSelectors = [
            'button[type="submit"]',
            'button:has-text("Create Account")',
            'button:has-text("ุฅูุดุงุก ุญุณุงุจ")',
            'button[data-testid="create-account-button"]',
            'button[aria-label="Create Account"]',
            'div[class*="submit"] button',
            'button[class*="submit"]',
            'button[class*="createAccount"]',
            'div[role="button"]:has-text("Create Account")',
            'button:has(> div:has-text("Create Account"))'
        ];
        
        // ูุญุงููุฉ ูู selector
        for (const selector of buttonSelectors) {
            try {
                const button = await this.page.$(selector);
                if (button) {
                    // ุงูุชุญูู ูู ุฃู ุงูุฒุฑ ูุฑุฆู ูููุนู
                    const isDisabled = await button.evaluate(el => el.disabled);
                    const isVisible = await button.evaluate(el => {
                        const style = window.getComputedStyle(el);
                        return style.display !== 'none' && style.visibility !== 'hidden';
                    });
                    
                    if (!isDisabled && isVisible) {
                        await button.click();
                        console.log(`โ ุชู ุงูููุฑ ุนูู ุฒุฑ Create Account ุจุงุณุชุฎุฏุงู: ${selector}`);
                        return true;
                    }
                }
            } catch (error) {
                // ุชุฌุงูู ุงูุฎุทุฃ ูุฌุฑุจ selector ุงูุชุงูู
            }
        }
        
        // ูุญุงููุฉ ุจุงุณุชุฎุฏุงู JavaScript ููุจุญุซ ูุงูููุฑ
        console.log('โ๏ธ  ุฃุฌุฑุจ ุงูุจุญุซ ุนู ุงูุฒุฑ ุจุงุณุชุฎุฏุงู JavaScript...');
        try {
            const clicked = await this.page.evaluate(() => {
                // ุงูุจุญุซ ุนู ุฌููุน ุงูุฃุฒุฑุงุฑ
                const buttons = document.querySelectorAll('button, div[role="button"], [onclick]');
                
                for (const element of buttons) {
                    const text = element.textContent || element.innerText || element.getAttribute('aria-label') || '';
                    const lowerText = text.toLowerCase();
                    
                    // ุงูุชุญูู ูู ูุฌูุฏ ูููุงุช ููุชุงุญูุฉ ูุฒุฑ ุงูุฅูุดุงุก
                    if (lowerText.includes('create account') || 
                        lowerText.includes('ุฅูุดุงุก ุญุณุงุจ') ||
                        lowerText.includes('continue') ||
                        lowerText.includes('ุงูุชุงูู') ||
                        lowerText.includes('sign up') ||
                        lowerText.includes('ุณุฌู')) {
                        
                        // ุงูุชุญูู ูู ุฃู ุงูุนูุตุฑ ูุฑุฆู ูุบูุฑ ูุนุทู
                        const style = window.getComputedStyle(element);
                        if (style.display !== 'none' && 
                            style.visibility !== 'hidden' &&
                            !element.disabled) {
                            
                            element.click();
                            console.log('ุชู ุงูููุฑ ุนูู:', text);
                            return true;
                        }
                    }
                }
                
                // ุฅุฐุง ูู ุชุฌุฏ ุฒุฑ ููุงุณุจุ ุญุงูู ุงูุนุซูุฑ ุนูู ุฒุฑ Submit
                const submitButtons = document.querySelectorAll('[type="submit"]');
                for (const button of submitButtons) {
                    if (!button.disabled) {
                        button.click();
                        return true;
                    }
                }
                
                return false;
            });
            
            if (clicked) {
                console.log('โ ุชู ุงูููุฑ ุนูู ุงูุฒุฑ ุจุงุณุชุฎุฏุงู JavaScript');
                return true;
            }
        } catch (error) {
            console.log('โ ูุดู ุงูููุฑ ุจุงุณุชุฎุฏุงู JavaScript:', error.message);
        }
        
        // ูุญุงููุฉ ุงูููุฑ ุจุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุฅุฐุง ูุงู ุงูุฒุฑ ูุฑุฆูุงู
        console.log('โ๏ธ  ุฃุฌุฑุจ ุงูููุฑ ุจุงุณุชุฎุฏุงู ุงูุฅุญุฏุงุซูุงุช...');
        try {
            await this.page.evaluate(() => {
                // ุงูุจุญุซ ุนู ุฃู ุนูุตุฑ ูุญุชูู ุนูู ูุต Create Account
                const elements = document.querySelectorAll('*');
                for (const element of elements) {
                    const text = element.textContent || element.innerText || '';
                    if (text.toLowerCase().includes('create account')) {
                        const rect = element.getBoundingClientRect();
                        if (rect.width > 0 && rect.height > 0) {
                            // ุงูููุฑ ูู ูุณุท ุงูุนูุตุฑ
                            const x = rect.left + rect.width / 2;
                            const y = rect.top + rect.height / 2;
                            
                            const clickEvent = new MouseEvent('click', {
                                view: window,
                                bubbles: true,
                                cancelable: true,
                                clientX: x,
                                clientY: y
                            });
                            
                            element.dispatchEvent(clickEvent);
                            return true;
                        }
                    }
                }
                return false;
            });
            
            console.log('โ ุชูุช ูุญุงููุฉ ุงูููุฑ ุจุงุณุชุฎุฏุงู ุงูุฅุญุฏุงุซูุงุช');
            return true;
        } catch (error) {
            console.log('โ ูุดู ุงูููุฑ ุจุงุณุชุฎุฏุงู ุงูุฅุญุฏุงุซูุงุช');
        }
        
        console.log('โ ูู ุฃุณุชุทุน ุงูููุฑ ุนูู ุฒุฑ Create Account!');
        return false;
    }

    // ุงูุญุตูู ุนูู ุงูุชููู
    async getDiscordToken() {
        try {
            return await this.page.evaluate(() => {
                // ุงูุจุญุซ ูู localStorage
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    if (value && value.length > 50) {
                        return value;
                    }
                }

                // ุงูุจุญุซ ูู sessionStorage
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    const value = sessionStorage.getItem(key);
                    if (value && value.length > 50) {
                        return value;
                    }
                }

                // ุงูุจุญุซ ูู cookies
                const cookies = document.cookie.split(';');
                for (const cookie of cookies) {
                    const [name, value] = cookie.trim().split('=');
                    if (value && value.length > 50) {
                        return value;
                    }
                }

                return null;
            });
        } catch (error) {
            console.error('โ ุฎุทุฃ ูู ุงูุญุตูู ุนูู ุงูุชููู:', error.message);
            return null;
        }
    }

    // ุฅูุดุงุก ุญุณุงุจ ูุงุญุฏ
    async createSingleAccount() {
        try {
            console.log('\n๐ ุฌูุจ ุงูุจูุงูุงุช ูู ุงููููุงุช...');

            // ูุฑุงุกุฉ ุฃูู ุณุทุฑ ูู ูู ููู
            const email = await this.readFirstLine('gmails.txt');
            const displayName = await this.readFirstLine('names.txt');
            const username = await this.readFirstLine('username.txt');
            const password = await this.readFirstLine('password.txt');

            // ุงูุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช
            if (!email || !displayName || !username || !password) {
                console.error('โ ูุง ุชูุฌุฏ ุจูุงูุงุช ูุงููุฉ ูู ุงููููุงุช!');
                return false;
            }

            console.log(`
๐ง ุงูุฅูููู: ${email}
๐ค Display Name: ${displayName}
๐ค ุงูููุฒุฑููู: ${username}
๐ ุงูุจุงุณูุฑุฏ: ${password}
            `);

            // ูุชุญ ุตูุญุฉ Discord ููุชุณุฌูู
            console.log('๐ ุงูุงูุชูุงู ุฅูู ุตูุญุฉ ุชุณุฌูู Discord...');
            await this.page.goto('https://discord.com/register', { 
                waitUntil: 'networkidle2',
                timeout: 30000
            });
            
            await this.randomDelay(2000, 3000);

            // ุงูุชุญูู ูู ุฃููุง ูู ุงูุตูุญุฉ ุงูุตุญูุญุฉ
            const pageUrl = await this.page.url();
            console.log(`๐ ุงูุฑุงุจุท ุงูุญุงูู: ${pageUrl}`);

            // ููุก ุญูู ุงูุฅูููู
            console.log('โ๏ธ  ุชุนุจุฆุฉ ุญูู ุงูุฅูููู...');
            await this.page.type('input[name="email"]', email, { delay: 30 });
            await this.randomDelay();

            // ููุก ุญูู Display Name
            console.log('โ๏ธ  ุชุนุจุฆุฉ ุญูู Display Name...');
            
            // ูุญุงููุฉ ุฅูุฌุงุฏ ุญูู Display Name
            const displayNameSelectors = [
                'input[name="displayName"]',
                'input[placeholder*="Display Name" i]',
                'input[aria-label*="Display Name" i]'
            ];
            
            const displayNameField = await this.findElement(displayNameSelectors);
            if (displayNameField) {
                await displayNameField.type(displayName, { delay: 30 });
                console.log('โ ุชู ููุก ุญูู Display Name');
            }
            await this.randomDelay();

            // ููุก ุญูู Username
            console.log('โ๏ธ  ุชุนุจุฆุฉ ุญูู Username...');
            await this.page.type('input[name="username"]', username, { delay: 30 });
            await this.randomDelay();

            // ููุก ุญูู Password
            console.log('โ๏ธ  ุชุนุจุฆุฉ ุญูู Password...');
            await this.page.type('input[name="password"]', password, { delay: 30 });
            await this.randomDelay(1000, 1500);

            // ููุก ุชุงุฑูุฎ ุงููููุงุฏ (23/9/1980 ูุน ุชุบููุฑุงุช ูู ุงูููู)
            const birthDate = this.generateDate();
            await this.fillBirthDate(birthDate);
            
            await this.randomDelay(1000, 1500);

            // ุงูุชูุงุท screenshot ูุจู ุงูุถุบุท ุนูู ุฒุฑ ุงูุฅูุดุงุก
            await this.page.screenshot({ path: 'before_creation.png' });
            console.log('๐ธ ุชู ุญูุธ ุตูุญุฉ ูุจู ุฅูุดุงุก ุงูุญุณุงุจ');

            console.log('\nโโโ ุฌููุน ุงูุญููู ููููุกุฉ ุจูุฌุงุญ! โโโ');
            console.log('   โ ุงูุฅูููู');
            console.log('   โ Display Name');
            console.log('   โ Username');
            console.log('   โ Password');
            console.log('   โ ุชุงุฑูุฎ ุงููููุงุฏ (23/9/1980 ูุน ุชุบููุฑุงุช ูู ุงูููู)');

            // ุงูุถุบุท ูุจุงุดุฑุฉ ุนูู ุฒุฑ Create Account
            console.log('\n๐ฏ ุฌุงุฑู ุงูููุฑ ุนูู ุฒุฑ Create Account ูุจุงุดุฑุฉ...');
            const buttonClicked = await this.clickCreateAccountButton();
            
            if (buttonClicked) {
                console.log('โ ุชู ุงูููุฑ ุนูู ุฒุฑ Create Account ุจูุฌุงุญ!');
                
                // ุงูุชุธุงุฑ 3 ุซูุงูู ุซู ุงูุชุญูู ูู ูุฌูุฏ ูุงุจุชุดุง
                await this.page.waitForTimeout(3000);
                
                // ุงูุชุญูู ูู ูุฌูุฏ ูุงุจุชุดุง
                const hasCaptcha = await this.page.evaluate(() => {
                    return document.querySelector('iframe[src*="captcha"]') !== null ||
                           document.querySelector('div[class*="captcha"]') !== null ||
                           document.querySelector('[data-testid="captcha"]') !== null;
                });
                
                if (hasCaptcha) {
                    console.log('\nโ๏ธ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ');
                    console.log('โ๏ธ   ููุฌุฏ Captcha! ูุฑุฌู ุญูู ูุฏููุงู ูู ุงููุชุตูุญ');
                    console.log('โ๏ธ   ุจุนุฏ ุญู ุงูู Captchaุ ุณูุณุชูุฑ ุงูุจุฑูุงูุฌ ุชููุงุฆูุงู');
                    console.log('โ๏ธ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ\n');
                    
                    // ุงูุชุธุงุฑ ุญู ุงููุงุจุชุดุง (5 ุฏูุงุฆู ูุญุฏ ุฃูุตู)
                    for (let i = 0; i < 60; i++) {
                        await this.page.waitForTimeout(5000);
                        
                        // ุงูุชุญูู ุฅุฐุง ุชู ุญู ุงููุงุจุชุดุง
                        const currentUrl = await this.page.url();
                        if (!currentUrl.includes('/register')) {
                            console.log('โ ุชู ุญู ุงูู Captcha ุจูุฌุงุญ!');
                            break;
                        }
                        
                        if (i % 6 === 0) { // ูู 30 ุซุงููุฉ
                            console.log(`โณ ูุง ูุฒุงู ูู ุงูุชุธุงุฑ ุญู ุงูู Captcha... (${(i+1)*5} ุซุงููุฉ)`);
                        }
                    }
                }
                
                // ุงูุชุธุงุฑ ุฅูุดุงุก ุงูุญุณุงุจ
                console.log('โณ ุงูุชุธุงุฑ ุฅูุดุงุก ุงูุญุณุงุจ... (10 ุซูุงูู)');
                await this.page.waitForTimeout(10000);

                // ุงูุชูุงุท screenshot ุจุนุฏ ุงูุฅูุดุงุก
                await this.page.screenshot({ path: 'after_creation.png' });
                console.log('๐ธ ุชู ุญูุธ ุตูุญุฉ ุจุนุฏ ุฅูุดุงุก ุงูุญุณุงุจ');

                // ูุญุงููุฉ ุงูุญุตูู ุนูู ุงูุชููู
                console.log('๐ ุฌุงุฑู ุงูุญุตูู ุนูู ุงูุชููู...');
                
                let token = null;
                for (let attempt = 1; attempt <= 3; attempt++) {
                    console.log(`๐ ุงููุญุงููุฉ ${attempt}/3 ููุญุตูู ุนูู ุงูุชููู...`);
                    token = await this.getDiscordToken();
                    
                    if (token) {
                        console.log(`โ ุชู ุงูุญุตูู ุนูู ุงูุชููู ูู ุงููุญุงููุฉ ${attempt}`);
                        break;
                    }
                    
                    if (attempt < 3) {
                        await this.page.waitForTimeout(3000);
                    }
                }

                if (token) {
                    console.log('๐ ุชู ุงูุญุตูู ุนูู ุงูุชููู ุจูุฌุงุญ!');
                    console.log(`๐ ุงูุชููู: ${token.substring(0, 30)}...`);
                    
                    // ุญูุธ ุงูุชููู
                    await fs.appendFile('tokens.txt', `${token}\n`, 'utf8');
                    console.log('๐พ ุชู ุญูุธ ุงูุชููู ูู tokens.txt');
                    
                    // ุญูุธ ูุนูููุงุช ุงูุญุณุงุจ
                    const accountInfo = `
[${new Date().toLocaleString()}]
๐ง ุงูุฅูููู: ${email}
๐ค Display Name: ${displayName}
๐ค ุงูููุฒุฑููู: ${username}
๐ ุงูุจุงุณูุฑุฏ: ${password}
๐ ุชุงุฑูุฎ ุงููููุงุฏ: ุณุจุชูุจุฑ/${birthDate.day}/1980
๐ ุงูุชููู: ${token.substring(0, 30)}...
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                    `;
                    
                    await fs.appendFile('accounts.txt', accountInfo, 'utf8');
                    console.log('๐ ุชู ุญูุธ ูุนูููุงุช ุงูุญุณุงุจ ูู accounts.txt');
                    
                    // ุญุฐู ุงูุฃุณุทุฑ ุงููุณุชุฎุฏูุฉ
                    await this.deleteFirstLine('gmails.txt');
                    await this.deleteFirstLine('names.txt');
                    await this.deleteFirstLine('username.txt');
                    await this.deleteFirstLine('password.txt');
                    
                    console.log('๐๏ธ  ุชู ุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงููููุงุช');
                    return token;
                } else {
                    console.log('โ ูู ูุชู ุงูุญุตูู ุนูู ุงูุชููู!');
                    
                    // ุญูุธ ุงููุนูููุงุช ุฑุบู ุนุฏู ูุฌูุฏ ุชููู
                    await fs.appendFile('no_token.txt', 
                        `${email}:${username}:${password}:${new Date().toISOString()}\n`, 
                        'utf8'
                    );
                    
                    // ุญุฐู ุงูุฃุณุทุฑ ุงููุณุชุฎุฏูุฉ
                    await this.deleteFirstLine('gmails.txt');
                    await this.deleteFirstLine('names.txt');
                    await this.deleteFirstLine('username.txt');
                    await this.deleteFirstLine('password.txt');
                    
                    console.log('โ๏ธ  ุชู ุญูุธ ุงูุญุณุงุจ ุจุฏูู ุชููู');
                    return false;
                }
            } else {
                console.log('โ ูู ุฃุณุชุทุน ุงูููุฑ ุนูู ุฒุฑ Create Account!');
                return false;
            }

        } catch (error) {
            console.error('โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุญุณุงุจ:', error.message);
            
            // ุญูุธ ุงูุฎุทุฃ ูู ููู
            const errorLog = `[${new Date().toISOString()}] ${error.message}\n`;
            await fs.appendFile('errors.log', errorLog, 'utf8');
            
            return false;
        }
    }

    async run() {
        console.log(`
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Discord Account Creator - 1980 Edition  โ
โ                                          โ
โ  โ ุชุงุฑูุฎ ุงููููุงุฏ: 23/9/1980             โ
โ  โ ูุถุบุท ุฒุฑ Create Account ูุจุงุดุฑุฉ        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        `);
        
        // ุงูุชุญูู ูู ูุฌูุฏ ุงููููุงุช
        const requiredFiles = ['gmails.txt', 'names.txt', 'username.txt', 'password.txt'];
        for (const file of requiredFiles) {
            if (!fsSync.existsSync(file)) {
                console.error(`โ ููู ${file} ุบูุฑ ููุฌูุฏ!`);
                console.log('๐ ูุฑุฌู ุฅูุดุงุก ุงููููุงุช ูุน ุงูุจูุงูุงุช ุฃููุงู');
                process.exit(1);
            }
        }

        try {
            console.log('๐ ุจุฏุก ุชุดุบูู ุงููุชุตูุญ...');
            
            // ุชุดุบูู ุงููุชุตูุญ
            this.browser = await puppeteer.launch({ 
                headless: false,
                defaultViewport: null,
                args: [
                    '--start-maximized',
                    '--no-sandbox',
                    '--disable-setuid-sandbox',
                    '--disable-dev-shm-usage'
                ]
            });
            
            // ุฅูุดุงุก ุตูุญุฉ
            this.page = await this.browser.newPage();
            
            // ุฅุนุฏุงุฏุงุช ูููุชุตูุญ
            await this.page.setUserAgent(
                'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
            );

            console.log('โ ุชู ูุชุญ ุงููุชุตูุญ');
            console.log('๐ฏ ุฌุงุฑู ุฅูุดุงุก ุญุณุงุจ ูุงุญุฏ...\n');

            // ุฅูุดุงุก ุญุณุงุจ
            const result = await this.createSingleAccount();
            
            if (result) {
                console.log('\nโจโจโจ ุชู ุฅูุดุงุก ุงูุญุณุงุจ ุจูุฌุงุญ! โจโจโจ');
            } else {
                console.log('\nโ๏ธ  ููุงู ูุดุงูู ูู ุฅูุดุงุก ุงูุญุณุงุจ');
            }

        } catch (error) {
            console.error('โ ุฎุทุฃ ุบูุฑ ูุชููุน:', error.message);
        } finally {
            // ุฅุบูุงู ุงููุชุตูุญ ุจุนุฏ 3 ุซูุงูู
            console.log('\nโณ ุฅุบูุงู ุงููุชุตูุญ ุจุนุฏ 3 ุซูุงูู...');
            await this.page.waitForTimeout(3000);
            
            if (this.browser) {
                await this.browser.close();
                console.log('โ ุชู ุฅุบูุงู ุงููุชุตูุญ');
            }
            
            console.log('\n๐ ููุฎุต ุงูุนูููุฉ:');
            console.log('   1. ููุฃ ุงูุฅูููู');
            console.log('   2. ููุฃ Display Name');
            console.log('   3. ููุฃ Username');
            console.log('   4. ููุฃ Password');
            console.log('   5. ููุฃ ุชุงุฑูุฎ ุงููููุงุฏ (ุณุจุชูุจุฑ/23/1980 ูุน ุชุบููุฑุงุช)');
            console.log('   6. ุถุบุท ุฒุฑ Create Account ูุจุงุดุฑุฉ');
            console.log('   7. ุญุงูู ุงูุญุตูู ุนูู ุงูุชููู');
            console.log('   8. ุญูุธ ุงูุชููู ูุญุฐู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ');
            console.log('   9. ุฃุบูู ุงููุชุตูุญ');
            
            console.log('\n๐ ููุชุดุบูู ูุฑุฉ ุฃุฎุฑูุ ุฃุนุฏ ุชุดุบูู ุงูุจุฑูุงูุฌ');
        }
    }
}

// ุชุดุบูู ุงูุจุฑูุงูุฌ
(async () => {
    const creator = new DiscordAccountCreator();
    await creator.run();
})();