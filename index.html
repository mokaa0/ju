// commands/banner.js
const { EmbedBuilder } = require('discord.js');
const { getGuildSettings } = require('../utils/settings');

module.exports = {
  name: 'banner',
  description: 'Show a user banner in an embed',

  async execute(message, args) {
    // التحقق من وجود منشن
    const user = message.mentions.users.first();
    if (!user) return message.reply('Please mention a user!');

    // جلب إعدادات السيرفر
    const settings = getGuildSettings(message.guild.id, { prefix: '#', embedColor: '#000000' });
    const embedColor = settings.embedColor
      ? parseInt(settings.embedColor.replace('#',''), 16)
      : 0x000000;

    // الحصول على البانر
    const bannerURL = user.bannerURL({ dynamic: true, size: 1024 });

    const userEmbed = new EmbedBuilder()
      .setColor(embedColor)
      .setTitle(`${user.tag}'s Banner`)
      .setDescription(`**ID:** ${user.id}\n**Username:** ${user.username}`)
      .setThumbnail(user.displayAvatarURL({ dynamic: true }))
      .setImage(bannerURL || null)
      .setFooter({ text: 'Requested by ' + message.author.tag, iconURL: message.author.displayAvatarURL({ dynamic: true }) })
      .setTimestamp();

    message.channel.send({ embeds: [userEmbed] });
  }
};