const puppeteer = require('puppeteer');
const fs = require('fs').promises;
const fsSync = require('fs');

class DiscordAccountCreator {
    constructor() {
        this.browser = null;
        this.page = null;
    }

    // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§ÙØªØªØ§Ø­ÙŠØ© Ø¨ØªØ£Ø«ÙŠØ± 3D
    showIntro() {
        console.clear(); // Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„ØªØµÙ…ÙŠÙ… 3D
        const colors = {
            reset: "\x1b[0m",
            bright: "\x1b[1m",
            dim: "\x1b[2m",
            underscore: "\x1b[4m",
            blink: "\x1b[5m",
            reverse: "\x1b[7m",
            hidden: "\x1b[8m",
            
            black: "\x1b[30m",
            red: "\x1b[31m",
            green: "\x1b[32m",
            yellow: "\x1b[33m",
            blue: "\x1b[34m",
            magenta: "\x1b[35m",
            cyan: "\x1b[36m",
            white: "\x1b[37m",
            
            bgBlack: "\x1b[40m",
            bgRed: "\x1b[41m",
            bgGreen: "\x1b[42m",
            bgYellow: "\x1b[43m",
            bgBlue: "\x1b[44m",
            bgMagenta: "\x1b[45m",
            bgCyan: "\x1b[46m",
            bgWhite: "\x1b[47m"
        };

        // ØªØµÙ…ÙŠÙ… 3D Ù„Ù„Ù†Øµ "ORIGINAL"
        console.log(`
${colors.bgBlack}${colors.bright}${colors.cyan}
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                              â•‘
â•‘  ${colors.bright}${colors.magenta}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.magenta}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.yellow}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.yellow}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.green}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.green}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.cyan}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.cyan}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.blue}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.blue}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.magenta}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘  ${colors.bright}${colors.magenta}   â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  ${colors.cyan}â•‘
â•‘                                                              â•‘
${colors.bright}${colors.red}â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—       â•‘
â•‘  â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘       â•‘
â•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
â•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
â•‘  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘       â•‘
â•‘   â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•       â•‘
â•‘                                                              â•‘
${colors.bright}${colors.yellow}â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â•‘
â•‘  â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â•‘
â•‘  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â•‘
â•‘  â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•    â•‘
â•‘                                                              â•‘
${colors.bright}${colors.cyan}â•‘               Discord Account Creator                â•‘
â•‘                  Version 3.0 - Ultimate                    â•‘
â•‘            For Research & Security Purposes Only           â•‘
â•‘                                                              â•‘
${colors.bright}${colors.green}â•‘       Date Range: ${colors.yellow}1980-2000${colors.green} | Auto Creation       â•‘
â•‘       Token Extraction | One Account Per Run             â•‘
â•‘                                                              â•‘
${colors.bright}${colors.cyan}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
${colors.reset}
`);

        console.log(`${colors.bright}${colors.green}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${colors.reset}`);
        console.log(`${colors.bright}${colors.yellow}ğŸš€ Starting Discord Account Creator...${colors.reset}`);
        console.log(`${colors.bright}${colors.cyan}ğŸ“… Current Date: ${new Date().toLocaleString()}${colors.reset}`);
        console.log(`${colors.bright}${colors.magenta}ğŸ¯ Target: One Account Creation Per Execution${colors.reset}`);
        console.log(`${colors.bright}${colors.green}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${colors.reset}\n`);
    }

    // Ù‚Ø±Ø§Ø¡Ø© Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ù…Ù„Ù
    async readFirstLine(filename) {
        try {
            if (!fsSync.existsSync(filename)) {
                console.error(`âŒ Ù…Ù„Ù ${filename} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!`);
                return null;
            }
            
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            return lines.length > 0 ? lines[0].trim() : null;
        } catch (error) {
            console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© ${filename}:`, error.message);
            return null;
        }
    }

    // Ø­Ø°Ù Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ù…Ù„Ù
    async deleteFirstLine(filename) {
        try {
            const content = await fs.readFile(filename, 'utf8');
            const lines = content.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length > 0) {
                const newContent = lines.slice(1).join('\n');
                await fs.writeFile(filename, newContent);
                console.log(`âœ… Ø­Ø°Ù Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† ${filename}`);
                return true;
            }
            return false;
        } catch (error) {
            console.error(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø± Ù…Ù† ${filename}:`, error.message);
            return false;
        }
    }

    // ØªÙˆÙ„ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 1980-2000
    generateRandomDate() {
        const startYear = 1980;
        const endYear = 2000;
        
        // Ø³Ù†Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¨ÙŠÙ† 1980 Ùˆ2000
        const year = Math.floor(Math.random() * (endYear - startYear + 1)) + startYear;
        
        // Ø´Ù‡Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 1-12
        const month = Math.floor(Math.random() * 12) + 1;
        
        // ÙŠÙˆÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 1-28 (Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±)
        const day = Math.floor(Math.random() * 28) + 1;
        
        console.log(`ğŸ² Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙÙˆÙ„Ø¯: ${day}/${month}/${year}`);
        
        return {
            month: month.toString(),
            day: day.toString(),
            year: year.toString()
        };
    }

    // Ø§Ù†ØªØ¸Ø§Ø± Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    async randomDelay(min = 500, max = 1000) {
        const delay = Math.floor(Math.random() * (max - min + 1)) + min;
        await this.page.waitForTimeout(delay);
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù†ØµØ± Ø¨Ø·Ø±Ù‚ Ù…Ø®ØªÙ„ÙØ©
    async findElement(selectors) {
        for (const selector of selectors) {
            try {
                const element = await this.page.$(selector);
                if (element) {
                    console.log(`âœ… ÙˆØ¬Ø¯Øª Ø§Ù„Ø¹Ù†ØµØ±: ${selector}`);
                    return element;
                }
            } catch (error) {
                // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£
            }
        }
        return null;
    }

    // Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ø¨ÙŠÙ† 1980-2000)
    async fillBirthDate(birthDate) {
        console.log('ğŸ‚ Ø¬Ø§Ø±ÙŠ Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯...');
        
        // Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ù„Ø¡ Ø§Ù„Ø´Ù‡Ø±
        const monthSelectors = [
            'select[aria-label="Month"]',
            'select[name="birthday_month"]',
            'select.monthSelect-2k6U8R',
            'select[class*="month"]'
        ];
        
        const monthSelect = await this.findElement(monthSelectors);
        if (monthSelect) {
            await monthSelect.select(birthDate.month);
            console.log(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ù‡Ø±: ${birthDate.month}`);
            await this.randomDelay();
        } else {
            console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ù‡Ø±');
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ù„Ø¡ Ø§Ù„ÙŠÙˆÙ…
        const daySelectors = [
            'select[aria-label="Day"]',
            'select[name="birthday_day"]',
            'select.daySelect-3mOPM3',
            'select[class*="day"]'
        ];
        
        const daySelect = await this.findElement(daySelectors);
        if (daySelect) {
            await daySelect.select(birthDate.day);
            console.log(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙŠÙˆÙ…: ${birthDate.day}`);
            await this.randomDelay();
        } else {
            console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙˆÙ…');
        }
        
        // Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ù„Ø¡ Ø§Ù„Ø³Ù†Ø© (1980-2000)
        const yearSelectors = [
            'select[aria-label="Year"]',
            'select[name="birthday_year"]',
            'select.yearSelect-2MGqHb',
            'select[class*="year"]'
        ];
        
        const yearSelect = await this.findElement(yearSelectors);
        if (yearSelect) {
            await yearSelect.select(birthDate.year);
            console.log(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø³Ù†Ø©: ${birthDate.year}`);
            await this.randomDelay();
        } else {
            console.log('âš ï¸  Ù„Ù… Ø£Ø¬Ø¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù†Ø©');
        }
        
        console.log(`ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${birthDate.day}/${birthDate.month}/${birthDate.year}`);
    }

    // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Create Account
    async clickCreateAccountButton() {
        console.log('ğŸ–±ï¸  Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø²Ø± Create Account...');
        
        const buttonSelectors = [
            'button[type="submit"]',
            'button:has-text("Create Account")',
            'button:has-text("Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨")',
            'button[aria-label*="Create Account"]',
            'button[class*="submit"]'
        ];
        
        // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø¹ Selectors
        for (const selector of buttonSelectors) {
            try {
                const button = await this.page.$(selector);
                if (button) {
                    const isVisible = await button.evaluate(el => {
                        const style = window.getComputedStyle(el);
                        return style.display !== 'none' && style.visibility !== 'hidden';
                    });
                    
                    if (isVisible) {
                        await button.click();
                        console.log(`âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±`);
                        return true;
                    }
                }
            } catch (error) {
                // ØªØ¬Ø§Ù‡Ù„
            }
        }
        
        // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript
        try {
            const clicked = await this.page.evaluate(() => {
                const buttons = document.querySelectorAll('button');
                for (const button of buttons) {
                    const text = (button.textContent || button.innerText || '').toLowerCase();
                    if (text.includes('create account') || 
                        text.includes('Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨') ||
                        button.type === 'submit') {
                        
                        const style = window.getComputedStyle(button);
                        if (style.display !== 'none' && style.visibility !== 'hidden') {
                            button.click();
                            return true;
                        }
                    }
                }
                return false;
            });
            
            if (clicked) {
                console.log('âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript');
                return true;
            }
        } catch (error) {
            console.log('âŒ ÙØ´Ù„ Ø§Ù„Ù†Ù‚Ø± Ø¨Ù€ JavaScript');
        }
        
        return false;
    }

    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†
    async getDiscordToken() {
        try {
            return await this.page.evaluate(() => {
                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ localStorage
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    if (value && value.length > 50) {
                        return value;
                    }
                }

                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ cookies
                const cookies = document.cookie.split(';');
                for (const cookie of cookies) {
                    const [name, value] = cookie.trim().split('=');
                    if (value && value.length > 50) {
                        return value;
                    }
                }

                return null;
            });
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†:', error.message);
            return null;
        }
    }

    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙˆØ§Ø­Ø¯
    async createSingleAccount() {
        try {
            console.log('\nğŸ“ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª...');

            // Ù‚Ø±Ø§Ø¡Ø© Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† ÙƒÙ„ Ù…Ù„Ù
            const email = await this.readFirstLine('gmails.txt');
            const displayName = await this.readFirstLine('names.txt');
            const username = await this.readFirstLine('username.txt');
            const password = await this.readFirstLine('password.txt');

            if (!email || !displayName || !username || !password) {
                console.error('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©!');
                return false;
            }

            console.log(`
ğŸ“§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„: ${email}
ğŸ‘¤ Display Name: ${displayName}
ğŸ”¤ Ø§Ù„ÙŠÙˆØ²Ø±Ù†ÙŠÙ…: ${username}
ğŸ” Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯: ${password}
            `);

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
            console.log('ğŸŒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Discord...');
            await this.page.goto('https://discord.com/register', { 
                waitUntil: 'domcontentloaded'
            });
            
            await this.randomDelay(2000, 3000);

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„...');
            await this.page.type('input[name="email"]', email, { delay: 50 });
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Display Name
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Display Name...');
            const displayNameField = await this.findElement(['input[name="displayName"]']);
            if (displayNameField) {
                await displayNameField.type(displayName, { delay: 50 });
                console.log('âœ… ØªÙ… Ù…Ù„Ø¡ Display Name');
            }
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Username
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Username...');
            await this.page.type('input[name="username"]', username, { delay: 50 });
            await this.randomDelay();

            // Ù…Ù„Ø¡ Ø­Ù‚Ù„ Password
            console.log('âœï¸  ØªØ¹Ø¨Ø¦Ø© Password...');
            await this.page.type('input[name="password"]', password, { delay: 50 });
            await this.randomDelay(1000, 1500);

            // Ù…Ù„Ø¡ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ø¨ÙŠÙ† 1980-2000)
            const birthDate = this.generateRandomDate();
            await this.fillBirthDate(birthDate);
            
            await this.randomDelay(1000, 1500);

            // Ø§Ù„ØªÙ‚Ø§Ø· screenshot
            await this.page.screenshot({ path: 'before_click.png' });

            console.log('\nâœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù…Ù…Ù„ÙˆØ¡Ø©!');
            console.log('   âœ“ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„');
            console.log('   âœ“ Display Name');
            console.log('   âœ“ Username');
            console.log('   âœ“ Password');
            console.log(`   âœ“ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${birthDate.day}/${birthDate.month}/${birthDate.year}`);

            // Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Create Account
            console.log('\nğŸ¯ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account...');
            const clicked = await this.clickCreateAccountButton();
            
            if (!clicked) {
                console.log('âŒ Ù„Ù… Ø£Ø³ØªØ·Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±ØŒ Ø£Ø¬Ø±Ø¨ ÙŠØ¯ÙˆÙŠØ§Ù‹...');
                console.log('âš ï¸  ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account ÙŠØ¯ÙˆÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­');
                await this.page.waitForTimeout(10000);
            } else {
                console.log('âœ… ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Create Account Ø¨Ù†Ø¬Ø§Ø­!');
            }

            // Ø§Ù†ØªØ¸Ø§Ø± Ù„Ø­Ù„ Ø§Ù„ÙƒØ§Ø¨ØªØ´Ø§ Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
            console.log('â³ Ø§Ù†ØªØ¸Ø§Ø± 5 Ø«ÙˆØ§Ù†Ù...');
            await this.page.waitForTimeout(5000);

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ÙƒØ§Ø¨ØªØ´Ø§
            const hasCaptcha = await this.page.evaluate(() => {
                return document.querySelector('iframe[src*="captcha"]') !== null ||
                       document.querySelector('div[class*="captcha"]') !== null;
            });

            if (hasCaptcha) {
                console.log('\nâš ï¸  ÙŠÙˆØ¬Ø¯ Captcha!');
                console.log('â³ ÙŠØ±Ø¬Ù‰ Ø­Ù„Ù‡ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø®Ù„Ø§Ù„ 60 Ø«Ø§Ù†ÙŠØ©...');
                await this.page.waitForTimeout(60000);
            }

            // Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
            console.log('â³ Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...');
            await this.page.waitForTimeout(8000);

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†
            console.log('ğŸ”‘ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†...');
            const token = await this.getDiscordToken();
            
            if (token) {
                console.log('âœ… ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†!');
                console.log(`ğŸ” Ø§Ù„ØªÙˆÙƒÙ†: ${token.substring(0, 30)}...`);
                
                // Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ†
                await fs.appendFile('tokens.txt', `${token}\n`);
                console.log('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ tokens.txt');
                
                // Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨
                const accountInfo = `[${new Date().toLocaleString()}] ${email} | ${username} | ${token.substring(0, 30)}...\n`;
                await fs.appendFile('accounts.txt', accountInfo);
                console.log('ğŸ“ ØªÙ… Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨');
                
                // Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('ğŸ—‘ï¸  ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©');
                return token;
            } else {
                console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†');
                
                // Ø­Ø°Ù Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ø­ØªÙ‰ Ù„Ùˆ ÙØ´Ù„
                await this.deleteFirstLine('gmails.txt');
                await this.deleteFirstLine('names.txt');
                await this.deleteFirstLine('username.txt');
                await this.deleteFirstLine('password.txt');
                
                console.log('ğŸ—‘ï¸  ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© (Ø­ØªÙ‰ Ù…Ø¹ ÙØ´Ù„ Ø§Ù„ØªÙˆÙƒÙ†)');
                return false;
            }

        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨:', error.message);
            return false;
        }
    }

    async run() {
        // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­
        this.showIntro();
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª
        const requiredFiles = ['gmails.txt', 'names.txt', 'username.txt', 'password.txt'];
        for (const file of requiredFiles) {
            if (!fsSync.existsSync(file)) {
                console.error(`âŒ Ù…Ù„Ù ${file} ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!`);
                return;
            }
        }

        try {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØªØµÙØ­...');
            
            this.browser = await puppeteer.launch({ 
                headless: false,
                defaultViewport: null,
                args: ['--start-maximized', '--no-sandbox']
            });
            
            this.page = await this.browser.newPage();
            
            await this.page.setUserAgent(
                'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'
            );

            console.log('âœ… ØªÙ… ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­');
            console.log('ğŸ¯ Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨...\n');

            const token = await this.createSingleAccount();
            
            if (token) {
                console.log('\nâœ¨âœ¨âœ¨ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! âœ¨âœ¨âœ¨');
            } else {
                console.log('\nâš ï¸  Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§ÙƒØªÙ…Ù„Øª Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„');
            }

        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:', error.message);
        } finally {
            console.log('\nâ³ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù...');
            await this.page.waitForTimeout(3000);
            
            if (this.browser) {
                await this.browser.close();
                console.log('âœ… ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ØªØµÙØ­');
            }
            
            console.log('\nğŸ“‹ Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©:');
            console.log('   1. Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§ÙØªØªØ§Ø­ÙŠØ© Ø¨ØªØ£Ø«ÙŠØ± 3D');
            console.log('   2. Ù‚Ø±Ø£ Ø£ÙˆÙ„ Ø³Ø·Ø± Ù…Ù† ÙƒÙ„ Ù…Ù„Ù');
            console.log('   3. Ù…Ù„Ø£ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ âœ“');
            console.log('   4. Ù…Ù„Ø£ Display Name âœ“');
            console.log('   5. Ù…Ù„Ø£ Username âœ“');
            console.log('   6. Ù…Ù„Ø£ Password âœ“');
            console.log('   7. Ù…Ù„Ø£ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (1980-2000 Ø¹Ø´ÙˆØ§Ø¦ÙŠ) âœ“');
            console.log('   8. Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Create Account âœ“');
            console.log('   9. Ø­Ø§ÙˆÙ„ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙƒÙ†');
            console.log('   10. Ø­ÙØ¸ Ø§Ù„ØªÙˆÙƒÙ† ÙˆØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª âœ“');
            console.log('   11. Ø£ØºÙ„Ù‚ Ø§Ù„Ù…ØªØµÙØ­ âœ“');
            
            console.log('\nğŸ”„ Ù„Ù„ØªØ´ØºÙŠÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ØŒ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬');
        }
    }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
(async () => {
    const creator = new DiscordAccountCreator();
    await creator.run();
})();