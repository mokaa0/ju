// send.js
const fs = require('fs');
const { Client } = require('discord.js-selfbot-v13'); // تحتاج تثبته: npm i discord.js-selfbot-v13

// قراءة الرسائل
const messages = fs.readFileSync('message.txt', 'utf-8').split('\n').filter(line => line.trim() !== '');

// قراءة التوكنات و الرومات
const accounts = fs.readFileSync('tokens.txt', 'utf-8')
    .split('\n')
    .map(line => line.trim())
    .filter(line => line && line.includes('|'))
    .map(line => {
        const [token, channelId] = line.split('|').map(v => v.trim());
        return { token, channelId };
    });

accounts.forEach(({ token, channelId }) => {
    const client = new Client();

    client.on('ready', async () => {
        console.log(`✅ Logged in as ${client.user.tag} - Channel: ${channelId}`);

        const channel = await client.channels.fetch(channelId).catch(() => null);
        if (!channel) {
            console.log(`❌ Couldn't find channel for token: ${token}`);
            return;
        }

        let count = 0;
        const sendMessage = () => {
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            channel.send(randomMessage).catch(err => console.log(`❌ Error sending message: ${err.message}`));

            count++;
            if (count >= 5) {
                count = 0;
                setTimeout(sendMessage, 1000); // استراحة 1 ثانية كل 5 رسائل
            } else {
                setTimeout(sendMessage, 200); // 0.2 ثانية بين الرسائل
            }
        };

        sendMessage();
    });

    client.login(token).catch(() => console.log(`❌ Failed to login with token: ${token}`));
});